"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8737],{41051:function(e,r,s){s.d(r,{Z:function(){return t}});var i=s(56626);let t=(0,i.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["line",{x1:"12",x2:"12",y1:"9",y2:"13",key:"1gkch0"}],["line",{x1:"12",x2:"12.01",y1:"17",y2:"17",key:"io3f8k"}]])},34800:function(e,r,s){s.d(r,{Z:function(){return t}});var i=s(56626);let t=(0,i.Z)("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},95347:function(e,r,s){s.d(r,{Z:function(){return ProjectList_ProjectCard}});var i=s(52322),t=s(34800),n=s(56626);let o=(0,n.Z)("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);var c=s(21209),a=s(46732);let inferProjectStatus=e=>{let r;switch(e.status){case a.S.ACTIVE_HEALTHY:r="isHealthy";break;case a.S.GOING_DOWN:case a.S.PAUSING:r="isPausing";break;case a.S.INACTIVE:r="isPaused";break;case a.S.RESTORING:r="isRestoring";break;case a.S.UNKNOWN:case a.S.COMING_UP:r="isComingUp"}return r};var l=s(24990),d=s(89435),u=s(81710);let g=(0,n.Z)("RefreshCcw",[["path",{d:"M3 2v6h6",key:"18ldww"}],["path",{d:"M21 12A9 9 0 0 0 6 5.3L3 8",key:"1pbrqz"}],["path",{d:"M21 22v-6h-6",key:"usdfbe"}],["path",{d:"M3 12a9 9 0 0 0 15 6.7l3-2.7",key:"1hosoe"}]]);var x=s(41051);let j=(0,n.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"16",y2:"12",key:"1y1yb1"}],["line",{x1:"12",x2:"12.01",y1:"8",y2:"8",key:"110wyk"}]]);var v=s(50074),h=s(4220),m=s(20644);let ProjectCardStatus=e=>{let{resourceWarnings:r,projectStatus:s}=e,t=(null==r?void 0:r.is_readonly_mode_enabled)?["is_readonly_mode_enabled"]:Object.keys(r||{}).filter(e=>"project"!==e&&"is_readonly_mode_enabled"!==e&&(null==r?void 0:r[e])!==null),n=t.some(e=>(null==r?void 0:r[e])==="critical"),o=t.includes("is_readonly_mode_enabled")||n,c=void 0!==r?(0,u.L)(r,t[0],"cardContent"):void 0,a="isPaused"===s?"Project is paused":"isPausing"===s?"Project is pausing":"isComingUp"===s?"Project is coming up":"isRestoring"===s?"Project is restoring":r?t.length>1?d.x.multiple_resource_warnings.cardContent[n?"critical":"warning"].title:null==c?void 0:c.title:void 0,p="isPaused"===s?"This project will not accept requests until resumed":"isPausing"===s?"The pause process will complete in a few minutes":"isComingUp"===s||"isRestoring"===s?"Your project will be ready in a few minutes":r?(t.length,null==c?void 0:c.description):void 0,f=o?"destructive":"isPaused"===s?"default":"warning";return(0===t.length||void 0===c)&&"isHealthy"===s?null:(0,i.jsxs)(v.bZ,{variant:f,className:(0,h.cn)("border-0 p-5 pb-[1.25rem]","bg-transparent","[&>svg]:left-[1.25rem] [&>svg]:top-3.5 [&>svg]:border",o?"":"[&>svg]:text-foreground [&>svg]:bg-surface-100"),children:["isPaused"===s||"isPausing"===s?(0,i.jsx)(m.Z,{strokeWidth:1.5,size:12}):"isRestoring"===s||"isComingUp"===s?(0,i.jsx)(g,{strokeWidth:1.5,size:12}):(0,i.jsx)(x.Z,{strokeWidth:1.5,size:12}),(0,i.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,i.jsx)(v.Cd,{className:"text-xs mb-0",children:a}),(0,i.jsxs)(l.fC,{delayDuration:0,children:[(0,i.jsx)(l.xz,{children:(0,i.jsx)(j,{size:14,className:"text-foreground-light hover:text-foreground"})}),(0,i.jsx)(l.h_,{children:(0,i.jsxs)(l.VY,{side:"bottom",children:[(0,i.jsx)(l.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border bg-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:p})})]})})]})]})]})};var ProjectList_ProjectCard=e=>{var r;let{project:s,rewriteHref:n,githubIntegration:l,vercelIntegration:d,resourceWarnings:u}=e,{name:g,ref:x}=s,j="".concat(s.cloud_provider," | ").concat(s.region),v=s.preview_branch_refs.length>0,h=null!==(r=null==l?void 0:l.metadata.name)&&void 0!==r?r:void 0,m=inferProjectStatus(s);return(0,i.jsx)("li",{className:"list-none",children:(0,i.jsx)(c.Z,{linkHref:n||"/project/".concat(x),className:"h-44 !px-0 group pt-5 pb-0",title:(0,i.jsxs)("div",{className:"w-full justify-between space-y-1.5 px-5",children:[(0,i.jsx)("p",{className:"flex-shrink truncate text-sm pr-4",children:g}),(0,i.jsx)("span",{className:"text-sm lowercase text-foreground-light",children:j}),(0,i.jsxs)("div",{className:"flex items-center space-x-1.5",children:[void 0!==d&&(0,i.jsx)("div",{className:"w-fit p-1 border rounded-md flex items-center border-controler",children:(0,i.jsx)("img",{src:"".concat(a.GW,"/img/icons/vercel-icon.svg"),alt:"Vercel Icon",className:"w-3"})}),v&&(0,i.jsx)("div",{className:"w-fit p-1 border rounded-md flex items-center border-controler",children:(0,i.jsx)(t.Z,{size:12,strokeWidth:1.5})}),void 0!==l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"w-fit p-1 border rounded-md flex items-center border-controler",children:(0,i.jsx)(o,{size:12,strokeWidth:1.5})}),(0,i.jsx)("p",{className:"text-xs !ml-2 text-foreground-light",children:h})]})]})]}),footer:(0,i.jsx)(ProjectCardStatus,{projectStatus:m,resourceWarnings:u})})})}},65030:function(e,r,s){var i=s(52322),t=s(21209);r.Z=()=>(0,i.jsx)(t.Z,{className:"h-44 !px-0 pt-5 pb-0",title:(0,i.jsxs)("div",{className:"w-full justify-between space-y-1.5 px-5",children:[(0,i.jsx)("p",{className:"flex-shrink truncate text-sm pr-4 shimmering-loader h-5 w-20"}),(0,i.jsx)("p",{className:"text-sm lowercase text-foreground-light h-4 w-40 shimmering-loader"})]})})},68737:function(e,r,s){s.d(r,{Z:function(){return _}});var i=s(52322),t=s(3440),n=s.n(t),o=s(46776),c=s(39097),a=s.n(c),l=s(94580),d=s(88058),u=s(7503),g=s(138),x=s(58943),j=s(3218),v=s(46732),h=s(48139);async function getOverdueInvoices(e){let r=await (0,j.U2)("".concat(v.T5,"/stripe/invoices/overdue"),{signal:e});if(r.error)throw r.error;return r}let useOverdueInvoicesQuery=function(){let{enabled:e=!0,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,x.a)(h.Y.overdueInvoices(),e=>{let{signal:r}=e;return getOverdueInvoices(r)},{enabled:e,...r})};var m=s(22634),p=s(66707),f=s(29659),y=s(99484),b=s(89465),N=s(71813),w=s(95347),k=s(65030),P=(0,o.Pi)(e=>{let{rewriteHref:r}=e,{data:s,isLoading:t,isSuccess:o}=(0,m.tl)(),{data:c,isLoading:a,isError:l,error:d}=(0,f.Sy)(),{isLoading:u,isError:g,error:x}=(0,p.j)(),{data:j}=(0,y.q)(),{data:h}=useOverdueInvoicesQuery({enabled:v.Qy}),b=n()(c,"organization_id"),N=!!v.Qy&&u;return t?(0,i.jsxs)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:[(0,i.jsx)(k.Z,{}),(0,i.jsx)(k.Z,{})]}):o&&s&&(null==s?void 0:s.length)>0?(0,i.jsx)(i.Fragment,{children:null==s?void 0:s.map(e=>(0,i.jsx)(OrganizationProjects,{organization:e,projects:b[e.id],overdueInvoices:(null!=h?h:[]).filter(r=>r.organization_id===e.id),resourceWarnings:null!=j?j:[],rewriteHref:r,isLoadingPermissions:N,isErrorPermissions:g,permissionsError:x,isLoadingProjects:a,isErrorProjects:l,projectsError:d},e.id))}):(0,i.jsx)(NoProjectsState,{slug:""})});let OrganizationProjects=e=>{let{organization:{name:r,slug:s,subscription_id:t},projects:n,overdueInvoices:o,resourceWarnings:c,isLoadingPermissions:d,isErrorPermissions:x,permissionsError:j,isLoadingProjects:v,isErrorProjects:h,projectsError:m,rewriteHref:p}=e,f=(0,b.lL)(),y=!n||0===n.length,{data:P}=(0,g.T)({orgSlug:null==f?void 0:f.slug}),_=null==P?void 0:P.filter(e=>"GitHub"===e.integration.name).flatMap(e=>e.connections),Z=null==P?void 0:P.filter(e=>"Vercel"===e.integration.name).flatMap(e=>e.connections);return(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex space-x-4 items-center",children:[(0,i.jsx)("h4",{className:"text-lg flex items-center",children:r}),!!o.length&&(0,i.jsx)("div",{children:(0,i.jsx)(l.z,{asChild:!0,type:"danger",children:(0,i.jsx)(a(),{href:"/org/".concat(s,"/invoices"),children:"Outstanding Invoices"})})})]}),d||v?(0,i.jsxs)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:[(0,i.jsx)(k.Z,{}),(0,i.jsx)(k.Z,{})]}):(0,i.jsx)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:x?(0,i.jsx)("div",{className:"col-span-3",children:(0,i.jsx)(u.Z,{subject:"Failed to retrieve permissions for your account",error:j})}):h?(0,i.jsx)("div",{className:"col-span-3",children:(0,i.jsx)(u.Z,{subject:"Failed to retrieve projects under ".concat(r),error:m})}):y?(0,i.jsx)(NoProjectsState,{slug:s}):null==n?void 0:n.map(e=>(0,i.jsx)(w.Z,{project:e,rewriteHref:p?p(e.ref):void 0,resourceWarnings:c.find(r=>r.project===e.ref),githubIntegration:null==_?void 0:_.find(r=>r.supabase_project_ref===e.ref),vercelIntegration:null==Z?void 0:Z.find(r=>r.supabase_project_ref===e.ref)},(0,N.pZ)(5)))})]},(0,N.pZ)(5))},NoProjectsState=e=>{let{slug:r}=e;return(0,i.jsxs)("div",{className:"col-span-4 space-y-4 rounded-lg border-2 border-dashed border-gray-300 p-6 text-center",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{children:"No projects"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Get started by creating a new project."})]}),(0,i.jsx)("div",{children:(0,i.jsx)(l.z,{asChild:!0,icon:(0,i.jsx)(d.Z,{}),children:(0,i.jsx)(a(),{href:"/new/".concat(r),children:"New Project"})})})]})};var _=P},48139:function(e,r,s){s.d(r,{Y:function(){return i}});let i={overdueInvoices:()=>["invoices","overdue"],invoice:e=>["invoice",e],list:(e,r,s)=>["invoices",e,r,s],count:(e,r)=>["invoices",e,r,"count"],projectInvoices:(e,r)=>["invoices",e,r],projectInvoicesCount:e=>["invoices",e,"count"],orgUpcomingPreview:e=>["invoices",e,"upcoming-preview"]}}}]);