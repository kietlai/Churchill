"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1872],{53242:function(e,t,s){var r=s(52322),n=s(73313),a=s(28879),o=s.n(a),l=s(2784),i=s(97036),c=s(94580),d=s(44607),u=s(73205),m=s(1872);t.Z=e=>{let{to:t,from:s,onChange:a,helpers:h}=e,g=(0,m.PJ)(h),[x,p]=(0,l.useState)(t||s?"":g.text),f=h.find(e=>t===e.calcTo()&&s===e.calcFrom());return(0,l.useEffect)(()=>{f&&x!==f.text?p(f.text):!f&&(t||s)&&p("")},[f,t,s]),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)(i.h_,{children:[(0,r.jsx)(i.$F,{asChild:!0,children:(0,r.jsx)(c.z,{type:x?"secondary":"default",icon:(0,r.jsx)(d.Z,{size:12}),className:"rounded-r-none",children:(0,r.jsx)("span",{children:(null==f?void 0:f.text)||g.text})})}),(0,r.jsx)(i.AW,{side:"bottom",align:"start",children:(0,r.jsx)(i._x,{onValueChange:e=>{let t=h.find(t=>t.text===e);a&&t&&a({to:t.calcTo(),from:t.calcFrom()})},value:(null==f?void 0:f.text)||"",children:h.map(e=>(0,r.jsx)(i.qB,{value:e.text,disabled:e.disabled,children:(0,r.jsx)("span",{className:[e.disabled?"text-foreground-light cursor-not-allowed":""].join(" "),children:e.text})},e.text))})})]}),(0,r.jsx)(n.M,{triggerButtonClassName:"rounded-l-none",triggerButtonType:f?"default":"secondary",triggerButtonTitle:"Custom",onChange:e=>{p(""),a&&a(e)},to:x?void 0:t,from:x?void 0:s,renderFooter:e=>{let{to:t,from:s}=e;if(t&&s&&Math.abs(o()(s).diff(o()(t),"day"))>m.$K)return(0,r.jsx)(u.b,{title:"",variant:"warning",className:"mx-3 pl-2 pr-2 pt-1 pb-2",children:"Large ranges may result in memory errors for big projects."})}})]})}},11734:function(e,t,s){var r=s(52322);t.Z=e=>{let{children:t}=e;return(0,r.jsx)("pre",{className:"text-foreground text-sm break-words py-4 px-3 w-full",children:t})}},36226:function(e,t,s){s.d(t,{$K:function(){return i},Eh:function(){return u},GT:function(){return genQueryParams},PJ:function(){return getDefaultHelper},U_:function(){return n},W:function(){return x},ae:function(){return m},bj:function(){return p},dl:function(){return g},fg:function(){return v},n7:function(){return l},tZ:function(){return h},up:function(){return f},xN:function(){return c}});var r,n,a=s(28879),o=s.n(a);let l="https://supabase.com/docs/guides/platform/logs#querying-with-the-logs-explorer",i=4,c=[{label:"Recent Errors",mode:"simple",searchString:"[Ee]rror|\\s[45][0-9][0-9]\\s",for:["api"]},{label:"Commits",mode:"simple",searchString:"COMMIT",for:["database"]},{label:"Commits By User",description:"Count of commits made by users on the database",mode:"custom",searchString:"select\n  p.user_name,\n  count(*) as count\nfrom postgres_logs\n  left join unnest(metadata) as m on true\n  left join unnest(m.parsed) as p on true\nwhere\n  regexp_contains(event_message, 'COMMIT')\ngroup by\n  p.user_name\n  ",for:["database"]},{label:"Metadata IP",description:"List all IP addresses that used the Supabase API",mode:"custom",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  h.x_real_ip\nfrom edge_logs\n  left join unnest(metadata) as m on true\n  left join unnest(m.request) as r on true\n  left join unnest(r.headers) as h on true\nwhere h.x_real_ip is not null\n",for:["api"]},{label:"Requests by Country",description:"List all ISO 3166-1 alpha-2 country codes that used the Supabase API",mode:"custom",searchString:"select\n  cf.country,\n  count(*) as count\nfrom edge_logs\n  left join unnest(metadata) as m on true\n  left join unnest(m.request) as r on true\n  left join unnest(r.cf) as cf on true\ngroup by\n  cf.country\norder by\n  count desc\n",for:["api"]},{label:"Slow Response Time",mode:"custom",description:"List all Supabase API requests that are slow",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  event_message,\n  r.origin_time\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.response) as r\nwhere\n  r.origin_time > 1000\norder by\n  timestamp desc\nlimit 100\n",for:["api"]},{label:"500 Request Codes",description:"List all Supabase API requests that responded witha 5XX status code",mode:"custom",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  event_message,\n  r.status_code\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.response) as r\nwhere\n  r.status_code >= 500\norder by\n  timestamp desc\nlimit 100\n",for:["api"]},{label:"Top Paths",description:"List the most requested Supabase API paths",mode:"custom",searchString:"select\n  r.path as path,\n  r.search as params,\n  count(timestamp) as c\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.request) as r\ngroup by\n  path,\n  params\norder by\n  c desc\nlimit 100\n",for:["api"]},{label:"REST Requests",description:"List all PostgREST requests",mode:"custom",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  event_message\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.request) as r\nwhere\n  path like '%rest/v1%'\norder by\n  timestamp desc\nlimit 100\n",for:["api"]},{label:"Errors",description:"List all Postgres error messages with ERROR, FATAL, or PANIC severity",mode:"custom",searchString:"select\n  cast(t.timestamp as datetime) as timestamp,\n  p.error_severity,\n  event_message\nfrom postgres_logs as t\n  cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as p\nwhere\n  p.error_severity in ('ERROR', 'FATAL', 'PANIC')\norder by\n  timestamp desc\nlimit 100\n",for:["database"]},{label:"Error Count by User",description:"Count of errors by users",mode:"custom",searchString:"select\n  count(t.timestamp) as count,\n  p.user_name,\n  p.error_severity\nfrom postgres_logs as t\n  cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as p\nwhere\n  p.error_severity in ('ERROR', 'FATAL', 'PANIC')\ngroup by\n  p.user_name,\n  p.error_severity\norder by\n  count desc\nlimit 100\n",for:["database"]},{label:"Auth Endpoint Events",description:"Endpoint events filtered by path",mode:"custom",searchString:'select\n  t.timestamp,\n  event_message\nfrom auth_logs as t\nwhere\n  regexp_contains(event_message,"level.{3}(info|warning||error|fatal)")\n  -- and regexp_contains(event_message,"path.{3}(/token|/recover|/signup|/otp)")\nlimit 100\n',for:["database"]},{label:"Storage Object Requests",description:"Number of requests done on Storage Objects",mode:"custom",searchString:"select\n  r.method as http_verb,\n  r.path as filepath,\n  count(*) as num_requests\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.request) AS r\n  cross join unnest(r.headers) AS h\nwhere\n  path like '%rest/v1/object%'\ngroup by \n  r.path, r.method\norder by\n  num_requests desc\nlimit 100\n",for:["api"]},{label:"Storage Top Cache Misses",description:"The top Storage requests that miss caching",mode:"custom",searchString:"select\n  r.path as path,\n  r.search as search,\n  count(id) as count\nfrom edge_logs f\n  cross join unnest(f.metadata) as m\n  cross join unnest(m.request) as r\n  cross join unnest(m.response) as res\n  cross join unnest(res.headers) as h\nwhere starts_with(r.path, '/storage/v1/object') \n  and r.method = 'GET'\n  and h.cf_cache_status in ('MISS', 'NONE/UNKNOWN', 'EXPIRED', 'BYPASS', 'DYNAMIC')\ngroup by path, search\norder by count desc\nlimit 100\n",for:["api"]}],d={search_query:e=>"regexp_contains(event_message, '".concat(e,"')")},u={postgres_logs:{...d,"severity.error":"parsed.error_severity in ('ERROR', 'FATAL', 'PANIC')","severity.noError":"parsed.error_severity not in ('ERROR', 'FATAL', 'PANIC')","severity.log":"parsed.error_severity = 'LOG'"},edge_logs:{...d,"status_code.error":"response.status_code between 500 and 599","status_code.success":"response.status_code between 200 and 299","status_code.warning":"response.status_code between 400 and 499","product.database":"request.path like '/rest/%' or request.path like '/graphql/%'","product.storage":"request.path like '/storage/%'","product.auth":"request.path like '/auth/%'","product.realtime":"request.path like '/realtime/%'","method.get":"request.method = 'GET'","method.post":"request.method = 'POST'","method.put":"request.method = 'PUT'","method.patch":"request.method = 'PATCH'","method.delete":"request.method = 'DELETE'","method.options":"request.method = 'OPTIONS'"},function_edge_logs:{...d,"status_code.error":"response.status_code between 500 and 599","status_code.success":"response.status_code between 200 and 299","status_code.warning":"response.status_code between 400 and 499"},function_logs:{...d,"severity.error":"metadata.level = 'error'","severity.notError":"metadata.level != 'error'","severity.log":"metadata.level = 'log'","severity.info":"metadata.level = 'info'","severity.debug":"metadata.level = 'debug'","severity.warn":"metadata.level = 'warn'"},auth_logs:{...d,"severity.error":"metadata.level = 'error' or metadata.level = 'fatal'","severity.warning":"metadata.level = 'warning'","severity.info":"metadata.level = 'info'","status_code.server_error":"metadata.status between 500 and 599","status_code.client_error":"metadata.status between 400 and 499","status_code.redirection":"metadata.status between 300 and 399","status_code.success":"metadata.status between 200 and 299","endpoints.admin":'REGEXP_CONTAINS(metadata.path, "/admin")',"endpoints.signup":'REGEXP_CONTAINS(metadata.path, "/signup|/invite|/verify")',"endpoints.authentication":'REGEXP_CONTAINS(metadata.path, "/token|/authorize|/callback|/otp|/magiclink")',"endpoints.recover":'REGEXP_CONTAINS(metadata.path, "/recover")',"endpoints.user":'REGEXP_CONTAINS(metadata.path, "/user")',"endpoints.logout":'REGEXP_CONTAINS(metadata.path, "/logout")'},realtime_logs:{...d},storage_logs:{...d},postgrest_logs:{...d},pgbouncer_logs:{...d},supavisor_logs:{...d}};(r=n||(n={})).EDGE="edge_logs",r.POSTGRES="postgres_logs",r.FUNCTIONS="function_logs",r.FN_EDGE="function_edge_logs",r.AUTH="auth_logs",r.REALTIME="realtime_logs",r.STORAGE="storage_logs",r.PGBOUNCER="pgbouncer_logs",r.POSTGREST="postgrest_logs",r.SUPAVISOR="supavisor_logs";let m={api:"edge_logs",database:"postgres_logs",functions:"function_logs",fn_edge:"function_edge_logs",auth:"auth_logs",realtime:"realtime_logs",storage:"storage_logs",postgrest:"postgrest_logs",pgbouncer:"pgbouncer_logs",supavisor:"supavisor_logs"},h={edge_logs:"Logs obtained from the network edge, containing all API requests",postgres_logs:"Database logs obtained directly from Postgres",function_logs:"Function logs generated from runtime execution",function_edge_logs:"Function call logs, containing the request and response",auth_logs:"Authentication logs from GoTrue",realtime_logs:"Realtime server for Postgres logical replication broadcasting",storage_logs:"Object storage logs",pgbouncer_logs:"Postgres connection pooler logs",postgrest_logs:"RESTful API web server logs",supavisor_logs:"Cloud-native Postgres connection pooler logs"},genQueryParams=e=>{for(let t in e){let s=e[t];(null===s||""===s||void 0===s)&&delete e[t]}let t=new URLSearchParams(e).toString();return t},g={postgres_logs:{severity:{label:"Severity",key:"severity",options:[{key:"error",label:"Error",description:"Show all events with ERROR, PANIC, or FATAL"},{key:"noError",label:"No Error",description:"Show all non-error events"},{key:"log",label:"Log",description:"Show all events that are log severity"}]}},edge_logs:{status_code:{label:"Status",key:"status_code",options:[{key:"error",label:"Error",description:"500 error codes"},{key:"success",label:"Success",description:"200 codes"},{key:"warning",label:"Warning",description:"400 codes"}]},product:{label:"Product",key:"product",options:[{key:"database",label:"Database",description:""},{key:"auth",label:"Auth",description:""},{key:"storage",label:"Storage",description:""},{key:"realtime",label:"Realtime",description:""}]},method:{label:"Method",key:"method",options:[{key:"get",label:"GET",description:""},{key:"options",label:"OPTIONS",description:""},{key:"put",label:"PUT",description:""},{key:"post",label:"POST",description:""},{key:"patch",label:"PATCH",description:""},{key:"delete",label:"DELETE",description:""}]}},function_edge_logs:{status_code:{label:"Status",key:"status_code",options:[{key:"error",label:"Error",description:"500 error codes"},{key:"success",label:"Success",description:"200 codes"},{key:"warning",label:"Warning",description:"400 codes"}]}},function_logs:{severity:{label:"Severity",key:"severity",options:[{key:"error",label:"Error",description:'Show all events that are "error" severity'},{key:"warn",label:"Warning",description:'Show all events that are "warn" severity'},{key:"info",label:"Info",description:'Show all events that are "info" severity'},{key:"debug",label:"Debug",description:'Show all events that are "debug" severity'},{key:"log",label:"Log",description:'Show all events that are "log" severity'}]}},auth_logs:{severity:{label:"Severity",key:"severity",options:[{key:"error",label:"Error",description:"Show all events that have error or fatal severity"},{key:"warning",label:"Warning",description:"Show all events that have warning severity"},{key:"info",label:"Info",description:"Show all events that have error severity"}]},status_code:{label:"Status Code",key:"status_code",options:[{key:"server_error",label:"Server Error",description:"Show all requests with 5XX status code"},{key:"client_error",label:"Client Error",description:"Show all requests with 4XX status code"},{key:"redirection",label:"Redirection",description:"Show all requests that have 3XX status code"},{key:"success",label:"Success",description:"Show all requests that have 2XX status code"}]},endpoints:{label:"Endpoints",key:"endpoints",options:[{key:"admin",label:"Admin",description:"Show all admin requests"},{key:"signup",label:"Sign up",description:"Show all signup and authorization requests"},{key:"recover",label:"Password Recovery",description:"Show all password recovery requests"},{key:"authentication",label:"Authentication",description:"Show all authentication flow requests (login, otp, and Oauth2)"},{key:"user",label:"User",description:"Show all user data requests"},{key:"logout",label:"Logout",description:"Show all logout requests"}]}}},x={log_selection_x_padding:"px-8",space_y:"px-6"},p=[{text:"Last hour",calcFrom:()=>o()().subtract(1,"hour").startOf("hour").toISOString(),calcTo:()=>"",default:!0},{text:"Last 3 hours",calcFrom:()=>o()().subtract(3,"hour").startOf("hour").toISOString(),calcTo:()=>""},{text:"Last 24 hours",calcFrom:()=>o()().subtract(1,"day").startOf("day").toISOString(),calcTo:()=>""}],f=[{text:"Last 24 hours",calcFrom:()=>o()().subtract(1,"day").startOf("day").toISOString(),calcTo:()=>"",default:!0},{text:"Last 3 days",calcFrom:()=>o()().subtract(3,"day").startOf("day").toISOString(),calcTo:()=>""},{text:"Last 7 days",calcFrom:()=>o()().subtract(7,"day").startOf("day").toISOString(),calcTo:()=>""}],getDefaultHelper=e=>e.find(e=>e.default)||e[0],v={FREE:{text:"1 day",value:1,unit:"day",promptUpgrade:!0},PRO:{text:"7 days",value:7,unit:"day",promptUpgrade:!0},PAYG:{text:"7 days",value:7,unit:"day",promptUpgrade:!0},TEAM:{text:"28 days",value:28,unit:"day",promptUpgrade:!0},ENTERPRISE:{text:"90 days",value:90,unit:"day",promptUpgrade:!1}}},32395:function(e,t,s){s.d(t,{TK:function(){return SeverityFormatter},VG:function(){return TextFormatter},VK:function(){return RowLayout},XA:function(){return ResponseCodeFormatter},Yj:function(){return SelectionDetailedRow},io:function(){return TimestampLocalFormatter},tS:function(){return SelectionDetailedTimestampRow},wi:function(){return timestampLocalFormatter},wv:function(){return jsonSyntaxHighlight}});var r=s(52322),n=s(19776),a=s(28879),o=s.n(a);s(2784);var l=s(39195),i=s(3689),c=s(1872);let RowLayout=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"flex h-full w-full items-center gap-4",children:t})},SelectionDetailedTimestampRow=e=>{let{value:t}=e;return(0,r.jsx)(SelectionDetailedRow,{label:"Timestamp",value:(0,c.Sj)(t)?(0,c.tI)(t):String(t)})},SelectionDetailedRow=e=>{let{label:t,value:s,valueRender:a}=e;return(0,r.jsxs)("div",{className:"grid grid-cols-12 group",children:[(0,r.jsx)("span",{className:"text-foreground-lighter text-sm col-span-4 whitespace-pre-wrap",children:t}),(0,r.jsx)("span",{className:"text-foreground text-sm col-span-6 whitespace-pre-wrap break-all",children:null!=a?a:s}),(0,r.jsx)(n.Z,{bounceIconOnCopy:!0,text:s,className:"group-hover:opacity-100 opacity-0 my-auto transition col-span-2  h-4 w-4 px-0 py-0",type:"text",title:"Copy to clipboard",children:""})]})},TextFormatter=e=>{let{value:t,className:s}=e;return(0,r.jsx)("span",{className:"font-mono text-xs truncate "+s,children:t})},ResponseCodeFormatter=e=>{let{value:t}=e;if(!t)return(0,r.jsx)("div",{children:(0,r.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});let s=t.toString().split("")[0];switch(s){case"1":case"2":return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded border bg-surface-200 px-2 py-1 text-center",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:t})})});case"5":return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded bg-red-400 px-2 py-1 text-center  ",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-red-1100",children:t})})});case"4":case"3":return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded bg-amber-400 px-2 py-1 text-center  ",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-amber-1100",children:t})})});default:return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded bg-surface-100 px-2 py-1 text-center  ",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:t})})})}},SeverityFormatter=e=>{let{value:t,uppercase:s=!0}=e;if(!t)return(0,r.jsx)("div",{children:(0,r.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});let n=t.toUpperCase(),a=s?n:t,Layout=e=>{let{className:t,children:s}=e;return(0,r.jsx)("div",{className:"w-24 flex items-center h-full ".concat(t),children:s})};switch(n){case"UNCAUGHTEXCEPTION":case"PANIC":case"FATAL":case"ERROR":return(0,r.jsxs)(Layout,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-red-900",children:(0,r.jsx)(l.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-red-900 !block titlecase",children:a})]});case"INFO":case"DEBUG":return(0,r.jsxs)(Layout,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,r.jsx)(l.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-blue-900 !block titlecase",children:a})]});case"LOG":return(0,r.jsxs)(Layout,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,r.jsx)(i.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-blue-900 !block titlecase",children:a})]});case"WARNING":return(0,r.jsxs)(Layout,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-amber-900",children:(0,r.jsx)(l.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-amber-900 !block titlecase",children:a})]});default:return(0,r.jsx)(Layout,{children:(0,r.jsx)("div",{className:"relative rounded px-2 py-1 text-center h-6 flex justify-center items-center bg-surface-100",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:a})})})}},TimestampLocalFormatter=e=>{let{value:t,className:s}=e;return(0,r.jsx)("span",{className:"text-xs ".concat(s),children:timestampLocalFormatter(t)})},timestampLocalFormatter=e=>{let t=(0,c.Sj)(e)?(0,c.tI)(e):e;return o()(t).format("DD MMM  HH:mm:ss")};function jsonSyntaxHighlight(e){let t=JSON.stringify(e,null,2);t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let s=t.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number text-tomato-900";return/^"/.test(e)?t=/:$/.test(e)?"key text-foreground":"string text-brand-600":/true|false/.test(e)?t="boolean text-blue-900":/null/.test(e)&&(t="null text-amber-1100"),'<span class="'+t+'">'+e+"</span>"}),r=s.split("\n").map(e=>'<span class="line text-xs">'.concat(e,"</span>"));return r.join("\n")}},1872:function(e,t,s){s.d(t,{up:function(){return n.up},n7:function(){return n.n7},$K:function(){return n.$K},tZ:function(){return n.tZ},ae:function(){return n.ae},_4:function(){return Logs_LogEventChart},ol:function(){return Logs_LogTable},dL:function(){return Logs_LogsQueryPanel},D8:function(){return Logs_SavedQueriesItem},U_:function(){return n.U_},bj:function(){return n.bj},Eh:function(){return n.Eh},xN:function(){return n.xN},fg:function(){return n.fg},AJ:function(){return ensureNoTimestampConflict},h6:function(){return fillTimeseries},g8:function(){return genChartQuery},My:function(){return genCountQuery},UR:function(){return genDefaultQuery},GT:function(){return n.GT},ue:function(){return genSingleLogQuery},PJ:function(){return n.PJ},Oy:function(){return isDefaultLogPreviewFormat},Sj:function(){return isUnixMicro},dP:function(){return maybeShowUpgradePrompt},tI:function(){return unixMicroToIsoTimestamp},Q9:function(){return useEditorHints}});var r=s(2784),n=s(36226),a=s(28879),o=s.n(a),l=s(72579),i=s.n(l),c=s(18149),d=s.n(c),u=s(79534),m=s(85377),h=s(35322),g=s(84636),x=s.n(g);let unixMicroToIsoTimestamp=e=>o().unix(Number(e)/1e3/1e3).toISOString(),isUnixMicro=e=>{let t=16===String(e).length,s=!Number.isNaN(Number(e));return s&&t},isDefaultLogPreviewFormat=e=>e&&e.timestamp&&e.event_message&&e.id,getDotKeys=(e,t)=>{let s=Object.keys(e).filter(t=>e[t]);return s.flatMap(s=>{let r=t?"".concat(t,".").concat(s):s;return"object"==typeof e[s]?getDotKeys(e[s],r):[r]})},genWhereStatement=(e,t)=>{let s=Object.keys(t),r=n.Eh[e],_resolveTemplateToStatement=e=>{let s=r[e],n=i()(t,e);return void 0!==n&&"function"==typeof s?s(n):void 0===s?"string"==typeof n?"".concat(e," = '").concat(n,"'"):"".concat(e," = ").concat(n):void 0===n&&"function"==typeof s?null:s&&!1===n?null:s},a=s.map(e=>{if("object"==typeof t[e]){let s=getDotKeys(t[e],e).map(_resolveTemplateToStatement).filter(Boolean);return s.length>0?"(".concat(s.join(" or "),")"):null}{let t=_resolveTemplateToStatement(e);return null===t?null:"(".concat(t,")")}}).filter(Boolean).join(" and ");return a?"where "+a:""},genDefaultQuery=(e,t)=>{let s=genWhereStatement(e,t),r=genCrossJoinUnnests(e),n="order by timestamp desc";switch(e){case"edge_logs":return"select id, timestamp, event_message, request.method, request.path, response.status_code\n  from ".concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ");case"postgres_logs":return"select postgres_logs.timestamp, id, event_message, parsed.error_severity from ".concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ");case"function_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.event_type, metadata.function_id, metadata.level from ").concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n    ");case"auth_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.level, metadata.status, metadata.path, metadata.msg as msg, metadata.error from ").concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n    ");case"function_edge_logs":return"select id, ".concat(e,".timestamp, event_message, response.status_code, request.method, m.function_id, m.execution_time_ms, m.deployment_id, m.version from ").concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ");default:return"select id, ".concat(e,".timestamp, event_message from ").concat(e,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ")}},genCrossJoinUnnests=e=>{switch(e){case"edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.request) as request\n  cross join unnest(m.response) as response";case"postgres_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as parsed";case"function_logs":case"auth_logs":return"cross join unnest(metadata) as metadata";case"function_edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.response) as response\n  cross join unnest(m.request) as request";default:return""}},genSingleLogQuery=(e,t)=>"select id, timestamp, event_message, metadata from ".concat(e," where id = '").concat(t,"' limit 1"),maybeShowUpgradePrompt=(e,t)=>{let s=Math.abs(o()().diff(o()(e),"day"));return s>1&&"free"===t||s>7&&"pro"===t||s>28&&"team"===t||s>90&&"enterprise"===t},genCountQuery=(e,t)=>{let s=genWhereStatement(e,t),r=genCrossJoinUnnests(e);return"SELECT count(*) as count FROM ".concat(e," ").concat(r," ").concat(s)},calcChartStart=e=>{let t=e.iso_timestamp_end?o()(e.iso_timestamp_end):o()(),s=e.iso_timestamp_start?o()(e.iso_timestamp_start):o()(),r="minute",n=360,a=t.diff(s,"minute"),l=t.diff(s,"hour");return a>720?(r="hour",n=120):l>72&&(r="day",n=7),[s.add(-n,r),r]},genChartQuery=(e,t,s)=>{let[r,n]=calcChartStart(t),a=genWhereStatement(e,s),o=genCrossJoinUnnests(e);return"\nSELECT\n-- log-event-chart\n  timestamp_trunc(t.timestamp, ".concat(n,") as timestamp,\n  count(t.timestamp) as count\nFROM\n  ").concat(e," t\n  ").concat(o,"\n  ").concat(a?a+" and t.timestamp > '".concat(r.toISOString(),"'"):"where t.timestamp > '".concat(r.toISOString(),"'"),"\nGROUP BY\ntimestamp\nORDER BY\n  timestamp ASC\n  ")},ensureNoTimestampConflict=(e,t)=>{let[s,r]=e,[n,a]=t;if(s&&r&&a&&!n){let e=o()(a).diff(o()(s)),t=o()(s);if(e<=0){let e=Math.abs(o()(r).diff(t,"minute"));t=o()(a).subtract(e,"minute")}return[t.toISOString(),a]}return!a&&n?[n,r]:[n,a]},useEditorHints=()=>{let e=(0,u.useMonaco)();(0,r.useEffect)(()=>{if(e){let t=e.languages.registerCompletionItemProvider("pgsql",{triggerCharacters:["`"," ","."],provideCompletionItems:function(t,s,r){let n=new h.Z(t,s.column-2,s.lineNumber-1);if(n.isNextDQuote())return{suggestions:[]};let a=[],o=m.Z.schemas.filter(e=>n._text.includes(e.reference));if(0===o.length&&(o=m.Z.schemas),n.isNextPeriod()){let t=o.flatMap(e=>e.fields),s=t.flatMap(e=>{let[t,...s]=e.path.split(".");return s}),r=s.map(t=>({label:t,kind:e.languages.CompletionItemKind.Property,insertText:t}));a=a.concat(r)}if("`"===r.triggerCharacter||" "===r.triggerCharacter){let t=m.Z.schemas.map(t=>({label:t.reference,kind:e.languages.CompletionItemKind.Class,insertText:t.reference})),s=o.flatMap(e=>e.fields),r=s.flatMap(e=>{let t=e.path.split(".");return t.slice(0,-1)}),n=r.map(t=>({label:t,kind:e.languages.CompletionItemKind.Property,insertText:t}));a=(a=a.concat(n)).concat(t)}return{suggestions:x()(a,"label")}}});return()=>{t.dispose()}}},[e])},fillTimeseries=(e,t,s,r,n,a)=>{if(e.length<=1&&!(n||a))return e;let l=e.map(e=>o().utc(e[t])),i=a?o().utc(a):o().utc(Math.max.apply(null,l)),c=n?o().utc(n):o().utc(Math.min.apply(null,l)),u=e.length>0?l:[c,i],m=getTimestampTruncation(u),h=e.map(e=>{let s=o().utc(e[t]).toISOString();return e[t]=s,e}),g=i.diff(c,m);if(g>1e4)throw Error("Data error, filling timeseries dynamically with more than 10k data points degrades performance.");for(let e=0;e<=g;e++){let n=c.add(e,m),a="string"==typeof s?[s]:s,o=a.reduce((e,t)=>({...e,[t]:r}),{});l.find(e=>d()(e,n))||h.push({[t]:n.toISOString(),...o})}return h},getTimestampTruncation=e=>{let t=e.reduce((e,t)=>{let s=_getTruncation(t);return e[s]+=1,e},{second:0,minute:0,hour:0,day:0}),s=Object.keys(t).reduce((e,s)=>t[e]>t[s]?e:s);return s},_getTruncation=e=>{let t=["second","minute","hour"].map(t=>e.get(t)),s=t.reduce((e,t)=>(0===t&&(e+=1),e),0);return({0:"second",1:"minute",2:"hour",3:"day"})[s]};var p=s(52322),f=s(5632),v=s(79569),j=s(94580),b=s(32152),y=s(44171),_=s(11734),w=s(32395),Logs_SavedQueriesItem=e=>{let{item:t}=e,[s,n]=(0,r.useState)(!1),a=(0,f.useRouter)(),{ref:o}=a.query;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(y.Z.tr,{className:"expandable-tr",children:[(0,p.jsx)(y.Z.td,{className:"whitespace-nowrap",children:(0,p.jsxs)("div",{className:"flex items-center gap-2",children:[(0,p.jsx)("button",{onClick:()=>n(!s),children:(0,p.jsx)("div",{className:"transition "+(s?"rotate-90":"rotate-0"),children:(0,p.jsx)(v.Z,{strokeWidth:2,size:14})})}),(0,p.jsx)("span",{className:"text-sm text-foreground",children:t.name})]})}),(0,p.jsx)(y.Z.td,{className:"",children:(0,p.jsx)("span",{className:"text-foreground-light",children:t.description})}),(0,p.jsx)(y.Z.td,{className:"",children:(0,p.jsx)("span",{className:"text-foreground-light",children:(0,w.wi)(t.inserted_at)})}),(0,p.jsx)(y.Z.td,{className:"",children:(0,p.jsx)("span",{className:"text-foreground-light",children:(0,w.wi)(t.updated_at)})}),(0,p.jsx)(y.Z.td,{className:" text-right",children:(0,p.jsx)(j.z,{type:"alternative",iconRight:(0,p.jsx)(b.Z,{size:10}),onClick:()=>a.push("/project/".concat(o,"/logs/explorer?q=").concat(encodeURIComponent(t.content.sql))),children:"Run"})})]},t.id),(0,p.jsx)(y.Z.td,{className:"".concat(s?" h-auto opacity-100":"h-0 opacity-0"," expanded-row-content border-l border-r bg-alternative !pt-0 !pb-0 transition-all"),colSpan:5,children:s&&(0,p.jsx)(_.Z,{children:t.content.sql})})]})},N=s(24990),S=s(59491),k=s(97036),R=s(43502),C=s(694),E=s(73205),L=s(84959),T=s(89465),I=s(46732),A=s(84447),O=s(39097),P=s.n(O),M=s(53242),Logs_LogsQueryPanel=e=>{let{templates:t=[],onSelectTemplate:s,hasEditorValue:r,onRun:a,onClear:o,onSave:l,onSelectSource:i,isLoading:c,defaultFrom:d,defaultTo:u,onDateChange:m,warnings:h}=e,{profile:g}=(0,A.Un)(),x=(0,T.Xo)(S.KA.CREATE,"user_content",{resource:{type:"log_sql",owner_id:null==g?void 0:g.id},subject:{id:null==g?void 0:g.id}}),{projectAuthAll:f,projectStorageAll:v,projectEdgeFunctionAll:y}=(0,T.N3)(["project_auth:all","project_storage:all","project_edge_function:all"]),_=Object.entries(n.U_).filter(e=>{let[t]=e;return"AUTH"===t?f:"STORAGE"===t?v:"FN_EDGE"!==t||y}).map(e=>{let[,t]=e;return t});return(0,p.jsx)("div",{className:"rounded rounded-bl-none rounded-br-none border border-overlay bg-surface-100",children:(0,p.jsx)("div",{className:"flex w-full items-center justify-between px-5 py-2",children:(0,p.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-x-4",children:[(0,p.jsxs)("div",{className:"flex items-center gap-2",children:[(0,p.jsxs)(k.h_,{children:[(0,p.jsx)(k.$F,{asChild:!0,children:(0,p.jsx)(j.z,{type:"default",iconRight:(0,p.jsx)(R.Z,{}),children:(0,p.jsx)("span",{children:"Insert source"})})}),(0,p.jsx)(k.AW,{side:"bottom",align:"start",children:_.sort((e,t)=>e.localeCompare(t)).map(e=>(0,p.jsx)(k.Xi,{onClick:()=>i(e),children:(0,p.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,p.jsx)("span",{className:"font-mono font-bold",children:e}),(0,p.jsx)("span",{className:"text-foreground-light",children:n.tZ[e]})]})},e))})]}),(0,p.jsxs)(k.h_,{children:[(0,p.jsx)(k.$F,{asChild:!0,children:(0,p.jsx)(j.z,{type:"default",iconRight:(0,p.jsx)(R.Z,{}),children:(0,p.jsx)("span",{children:"Templates"})})}),(0,p.jsx)(k.AW,{side:"bottom",align:"start",children:t.sort((e,t)=>e.label.localeCompare(t.label)).map(e=>(0,p.jsx)(k.Xi,{onClick:()=>s(e),children:(0,p.jsx)("p",{children:e.label})},e.label))})]}),(0,p.jsx)(M.Z,{to:u,from:d,onChange:m,helpers:n.up}),(0,p.jsx)("div",{className:"overflow-hidden",children:(0,p.jsx)("div",{className:" transition-all duration-300 ".concat(h.length>0?"opacity-100":"invisible h-0 w-0 opacity-0"),children:(0,p.jsx)(C.Z,{overlay:(0,p.jsx)(E.b,{variant:"warning",title:"",children:(0,p.jsx)("div",{className:"flex flex-col gap-3",children:h.map((e,t)=>(0,p.jsxs)("p",{children:[e.text," ",e.link&&(0,p.jsx)(P(),{href:e.link,children:e.linkText||"View"})]},t))})}),children:(0,p.jsxs)(L.Z,{color:"yellow",children:[h.length," ",h.length>1?"warnings":"warning"]})})})})]}),(0,p.jsx)("div",{children:(0,p.jsxs)("div",{className:"flex items-center gap-4",children:[(0,p.jsxs)("div",{className:"flex items-center gap-2",children:[(0,p.jsx)(j.z,{type:"default",onClick:o,children:"Clear query"}),I.Qy&&l&&(0,p.jsxs)(N.fC,{delayDuration:0,children:[(0,p.jsx)(N.xz,{asChild:!0,children:(0,p.jsx)(j.z,{type:"default",onClick:()=>l(),disabled:!x||!r,children:"Save query"})}),!x&&(0,p.jsx)(N.h_,{children:(0,p.jsxs)(N.VY,{side:"bottom",children:[(0,p.jsx)(N.Eh,{className:"radix-tooltip-arrow"}),(0,p.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,p.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to save your query"})})]})})]})]}),(0,p.jsx)(j.z,{type:r?"primary":"alternative",disabled:!r,onClick:a,iconRight:(0,p.jsx)(b.Z,{}),loading:c,children:"Run"})]})})]})})})},D=s(47370),F=s(77784),q=s(92553),Z=s(49097),U=s(13392),G=s(71813);let defaultRenderCell=e=>(0,p.jsxs)(w.VK,{children:[(0,p.jsx)(w.io,{value:e.row.timestamp}),(0,p.jsx)(w.VG,{className:"w-full",value:e.row.event_message})]});var W=[{name:"default-preview-first-column",key:"default-preview-first-column",renderCell:defaultRenderCell}];let Y=[{name:"auth-first-column",key:"auth-first-column",renderCell:e=>{var t;return e.row.level?(0,p.jsxs)(w.VK,{children:[(0,p.jsx)(w.io,{value:e.row.timestamp}),e.row.level&&(0,p.jsx)(w.TK,{value:e.row.level}),(0,p.jsx)(w.VG,{className:"w-full",value:"".concat(e.row.path?e.row.path+" | ":"").concat((null===(t=e.row.msg)||void 0===t?void 0:t.trim())||e.row.event_message)})]}):defaultRenderCell(e)}}],z=[{name:"database-api-first-column",key:"database-api-first-column",renderCell:e=>e.row.status_code||e.row.method||e.row.path?(0,p.jsxs)(w.VK,{children:[(0,p.jsx)(w.io,{value:e.row.timestamp}),(0,p.jsx)(w.XA,{row:e,value:e.row.status_code}),(0,p.jsx)(w.VG,{className:"w-20",value:e.row.method}),(0,p.jsx)(w.VG,{className:"w-full",value:e.row.path})]}):defaultRenderCell(e)}],K=[{name:"database-postgres-first-column",key:"database-postgres-first-column",renderCell:e=>e.row.error_severity?(0,p.jsxs)(w.VK,{children:[(0,p.jsx)(w.io,{value:e.row.timestamp}),(0,p.jsx)(w.TK,{value:e.row.error_severity}),(0,p.jsx)(w.VG,{className:"w-full",value:e.row.event_message})]}):defaultRenderCell(e)}],H=[{name:"functions-edge-first-column",key:"functions-edge-first-column",renderCell:e=>e.row.status_code||e.row.method?(0,p.jsxs)(w.VK,{children:[(0,p.jsx)(w.io,{value:e.row.timestamp}),(0,p.jsx)(w.XA,{row:e,value:e.row.status_code}),(0,p.jsx)(w.VG,{value:e.row.method}),(0,p.jsx)(w.VG,{value:e.row.id})]}):defaultRenderCell(e)}],X=[{name:"functions-logs-first-column",key:"functions-logs-first-column",renderCell:e=>e.row.event_type||e.row.level?(0,p.jsxs)(w.VK,{children:[(0,p.jsx)(w.io,{value:e.row.timestamp}),"uncaughtException"===e.row.event_type?(0,p.jsx)(w.TK,{value:e.row.event_type,uppercase:!1}):(0,p.jsx)(w.TK,{value:e.row.level}),(0,p.jsx)(w.VG,{className:"w-full",value:e.row.event_message})]}):defaultRenderCell(e)}];var V=s(88979),J=s(19776),Q=s(67950),B=s(3218),$=s(58943),analytics_useSingleLog=function(e,t,s,r){let a=t?n.ae[t]:void 0,o=r&&a?genSingleLogQuery(a,r):"",l={...s,project:e,sql:o},i="".concat(I.T5,"/projects/").concat(e,"/analytics/endpoints/logs.all?").concat((0,n.GT)(l)),c=!!(r&&a),{data:d,error:u,isLoading:m,isRefetching:h,refetch:g}=(0,$.a)(["projects",e,"log",r],e=>{let{signal:t}=e;return(0,B.U2)(i,{signal:t})},{enabled:c,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),x=u?u.message:null;return{logData:(null==d?void 0:d.result)?d.result[0]:void 0,isLoading:c&&m||h,error:x,refresh:()=>g()}},LogSelectionRenderers_AuthSelectionRenderer=e=>{var t,s,r,a,o,l,i,c,d,u,m;let{log:h}=e;return(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-6"),children:[(0,p.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,p.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Event Message"}),(0,p.jsx)("div",{className:"text-xs text-wrap font-mono text-foreground whitespace-pre-wrap overflow-x-auto",children:(null===(t=h.metadata)||void 0===t?void 0:t.msg)||h.event_message})]}),(0,p.jsx)(w.tS,{value:h.timestamp}),(null===(s=h.metadata)||void 0===s?void 0:s.status)&&(0,p.jsx)(w.Yj,{label:"Status",value:String(null===(r=h.metadata)||void 0===r?void 0:r.status),valueRender:(0,p.jsx)(w.XA,{value:null===(a=h.metadata)||void 0===a?void 0:a.status})}),(null===(o=h.metadata)||void 0===o?void 0:o.level)&&(0,p.jsx)(w.Yj,{label:"Severity",value:null===(l=h.metadata)||void 0===l?void 0:l.level,valueRender:(0,p.jsx)(w.TK,{value:null===(i=h.metadata)||void 0===i?void 0:i.level})}),(null===(c=h.metadata)||void 0===c?void 0:c.path)&&(0,p.jsx)(w.Yj,{label:"Request Path",value:null===(d=h.metadata)||void 0===d?void 0:d.path}),(null===(u=h.metadata)||void 0===u?void 0:u.error)&&(0,p.jsx)(w.Yj,{label:"Error Message",value:null===(m=h.metadata)||void 0===m?void 0:m.error}),(0,p.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,p.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Metadata"}),(0,p.jsx)("pre",{className:" className={`text-foreground text-sm col-span-8 overflow-x-auto text-xs font-mono`}",dangerouslySetInnerHTML:{__html:(0,w.wv)(h.metadata)}})]})]})},Logs_Divider=()=>(0,p.jsx)("div",{className:"h-px w-full bg-panel-border-interior-light [[data-theme*=dark]_&]:bg-panel-border-interior-dark"}),LogSelectionRenderers_DatabaseApiSelectionRender=e=>{var t,s,r,a,o,l,i,c,d,u,m,h;let{log:g}=e,x=null==g?void 0:null===(s=g.metadata[0])||void 0===s?void 0:null===(t=s.request)||void 0===t?void 0:t[0],f=null==g?void 0:null===(a=g.metadata[0])||void 0===a?void 0:null===(r=a.response)||void 0===r?void 0:r[0],v=null==x?void 0:x.method,j=null==f?void 0:f.status_code,b=null==x?void 0:null===(l=x.headers)||void 0===l?void 0:null===(o=l[0])||void 0===o?void 0:o.cf_connecting_ip,y=null==x?void 0:null===(c=x.headers)||void 0===c?void 0:null===(i=c[0])||void 0===i?void 0:i.cf_ipcountry,_=null==x?void 0:null===(u=x.headers)||void 0===u?void 0:null===(d=u[0])||void 0===d?void 0:d.x_client_info,N=null==x?void 0:null===(h=x.headers)||void 0===h?void 0:null===(m=h[0])||void 0===m?void 0:m.referer;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,p.jsx)(w.Yj,{label:"Status",value:j,valueRender:(0,p.jsx)(w.XA,{value:j})}),(0,p.jsx)(w.Yj,{label:"Method",value:v}),(0,p.jsx)(w.tS,{value:g.timestamp}),(0,p.jsx)(w.Yj,{label:"IP Address",value:b}),(0,p.jsx)(w.Yj,{label:"Origin Country",value:y}),_&&(0,p.jsx)(w.Yj,{label:"Client",value:_}),N&&(0,p.jsx)(w.Yj,{label:"Referer",value:N})]}),(0,p.jsx)(Logs_Divider,{}),(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,p.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Request Metadata"}),(0,p.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,p.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:x?(0,w.wv)(g.metadata[0].request[0]):""}})})]}),(0,p.jsx)(Logs_Divider,{}),(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,p.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Response Metadata"}),(0,p.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,p.jsx)("div",{dangerouslySetInnerHTML:{__html:f?(0,w.wv)(g.metadata[0].response[0]):""}})})]})]})},LogSelectionRenderers_DatabasePostgresSelectionRender=e=>{var t,s,r,a,o,l,i,c;let{log:d}=e,u=null==d?void 0:null===(s=d.metadata[0])||void 0===s?void 0:null===(t=s.parsed[0])||void 0===t?void 0:t.user_name,m=null==d?void 0:null===(a=d.metadata[0])||void 0===a?void 0:null===(r=a.parsed[0])||void 0===r?void 0:r.session_id,h=null==d?void 0:null===(l=d.metadata[0])||void 0===l?void 0:null===(o=l.parsed[0])||void 0===o?void 0:o.hint,g=null==d?void 0:null===(c=d.metadata[0])||void 0===c?void 0:null===(i=c.parsed[0])||void 0===i?void 0:i.error_severity;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:n.W.log_selection_x_padding,children:[(0,p.jsx)("span",{className:"col-span-4 text-sm text-foreground-lighter",children:"Event message"}),(0,p.jsx)("div",{className:"text-wrap mt-2 overflow-x-auto whitespace-pre-wrap font-mono  text-xs text-foreground",children:d.event_message})]}),(0,p.jsx)(Logs_Divider,{}),(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,p.jsx)(w.Yj,{label:"Severity",value:g,valueRender:(0,p.jsx)(w.TK,{value:g})}),(0,p.jsx)(w.tS,{value:d.timestamp}),(0,p.jsx)(w.Yj,{label:"Postgres Username",value:u}),(0,p.jsx)(w.Yj,{label:"Session ID",value:m})]}),h&&(0,p.jsx)("div",{className:"mt-4 ".concat(n.W.log_selection_x_padding),children:(0,p.jsx)(E.b,{variant:"warning",withIcon:!0,title:h})}),(0,p.jsx)(Logs_Divider,{}),(0,p.jsxs)("div",{className:n.W.log_selection_x_padding,children:[(0,p.jsx)("h3",{className:"mb-4 text-lg text-foreground",children:"Metadata"}),(0,p.jsx)("pre",{className:"syntax-highlight overflow-x-auto text-sm",children:(0,p.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:d.metadata?(0,w.wv)(d.metadata[0]):""}})})]})]})},LogSelectionRenderers_DefaultExplorerSelectionRenderer=e=>{let{log:t}=e,DetailedJsonRow=e=>{let{label:t,value:s,code:r}=e;return(0,p.jsxs)("div",{className:"grid grid-cols-12",children:[(0,p.jsx)("span",{className:"text-foreground-lighter text-sm col-span-4",children:t}),(0,p.jsx)("span",{className:"text-foreground text-sm col-span-8 overflow-x-auto ".concat(r&&"text-xs font-mono"),children:(0,p.jsx)("pre",{dangerouslySetInnerHTML:{__html:(0,w.wv)(s)}})})]})};return(0,p.jsx)("div",{className:"overflow-hidden overflow-x-auto space-y-6",children:Object.entries(t).map((e,t)=>{let[s,r]=e;return(0,p.jsx)("div",{className:"".concat(n.W.log_selection_x_padding),children:r&&"object"==typeof r?(0,p.jsx)(DetailedJsonRow,{label:s,value:r}):(0,p.jsx)(w.Yj,{label:s,value:null===r?"NULL ":String(r)})},"".concat(s,"-").concat(t))})})},LogSelectionRenderers_DefaultPreviewSelectionRenderer=e=>{let{log:t}=e;return(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-6"),children:[(0,p.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,p.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Event Message"}),(0,p.jsx)("div",{className:"text-xs text-wrap font-mono text-foreground whitespace-pre-wrap overflow-x-auto",children:t.event_message})]}),(0,p.jsx)(w.tS,{value:t.timestamp}),(0,p.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,p.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Metadata"}),(0,p.jsx)("pre",{className:" className={`text-foreground text-sm col-span-8 overflow-x-auto text-xs font-mono`}",dangerouslySetInnerHTML:{__html:(0,w.wv)(t.metadata||{})}})]})]})};function filterFunctionsRequestResponse(e){return Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!["host","url"].includes(t)}).map(e=>{let[t,s]=e;return"headers"===t?[t,s.map(e=>Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!t.startsWith("_")})))]:[t,s]}))}var LogSelectionRenderers_FunctionInvocationSelectionRender=e=>{var t,s,r;let{log:a}=e,o=null===(t=a.metadata)||void 0===t?void 0:t[0],l=null==o?void 0:null===(s=o.request)||void 0===s?void 0:s[0],i=null==o?void 0:null===(r=o.response)||void 0===r?void 0:r[0],c=null==l?void 0:l.method,d=null==i?void 0:i.status_code,u=(null==l?void 0:l.url)!==void 0?new URL(null==l?void 0:l.url):void 0,m=o.execution_time_ms,h=o.deployment_id;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,p.jsx)(w.Yj,{label:"Status",value:d,valueRender:(0,p.jsx)(w.XA,{value:d})}),(0,p.jsx)(w.Yj,{label:"Method",value:c}),(0,p.jsx)(w.tS,{value:a.timestamp}),(0,p.jsx)(w.Yj,{label:"Execution Time",value:"".concat(m,"ms")}),(0,p.jsx)(w.Yj,{label:"Deployment ID",value:h}),(0,p.jsx)(w.Yj,{label:"Log ID",value:a.id}),void 0!==u&&(0,p.jsx)(w.Yj,{label:"Request Path",value:u.pathname+u.search})]}),(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,p.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Request Metadata"}),(0,p.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,p.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:l?(0,w.wv)(filterFunctionsRequestResponse(l)):""}})})]}),(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,p.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Response Metadata"}),(0,p.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,p.jsx)("div",{dangerouslySetInnerHTML:{__html:i?(0,w.wv)(filterFunctionsRequestResponse(i)):""}})})]})]})},LogSelectionRenderers_FunctionLogsSelectionRender=e=>{let{log:t}=e,s=t.metadata[0];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,p.jsx)("span",{className:"text-foreground-lighter text-sm col-span-4",children:"Event message"}),(0,p.jsx)("div",{className:"text-xs text-wrap font-mono text-foreground mt-2 whitespace-pre-wrap overflow-x-auto",children:t.event_message})]}),(0,p.jsx)("div",{className:"h-px w-full bg-panel-border-interior-light [[data-theme*=dark]_&]:bg-panel-border-interior-dark"}),(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,p.jsx)(w.Yj,{label:"Severity",value:s.level,valueRender:(0,p.jsx)(w.TK,{value:s.level})}),(0,p.jsx)(w.Yj,{label:"Deployment version",value:s.version}),(0,p.jsx)(w.tS,{value:t.timestamp}),(0,p.jsx)(w.Yj,{label:"Execution ID",value:s.execution_id}),(0,p.jsx)(w.Yj,{label:"Deployment ID",value:s.deployment_id})]}),(0,p.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,p.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Metadata"}),(0,p.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,p.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:s?(0,w.wv)(s):""}})})]})]})},Logs_LogSelection=e=>{let{projectRef:t,log:s,onClose:n,queryType:a,params:o={}}=e,{logData:l,isLoading:i}=analytics_useSingleLog(t,a,o,null==s?void 0:s.id),c=(0,r.useMemo)(()=>l&&a?"Log ID\n".concat(l.id,"\n\nLog Timestamp (UTC)\n").concat(isUnixMicro(l.timestamp)?unixMicroToIsoTimestamp(l.timestamp):l.timestamp,"\n\nLog Event Message\n").concat(l.event_message,"\n\nLog Metadata\n").concat(JSON.stringify(l.metadata,null,2),"\n"):JSON.stringify(l||s,null,2),[l]);return(0,p.jsxs)("div",{className:"relative flex h-full flex-grow flex-col border border-l border-overlay overflow-y-scroll bg-background",children:[(0,p.jsx)("div",{className:"absolute flex\n          h-full w-full flex-col items-center justify-center gap-2 overflow-y-scroll bg-background text-center opacity-0 transition-all "+(s?"z-0 opacity-0":"z-10 opacity-100"),children:(0,p.jsxs)("div",{className:"flex\n          w-full\n          max-w-sm\n          scale-95\n          flex-col\n          items-center\n          justify-center\n          gap-6\n          text-center\n          opacity-0\n          transition-all delay-300 duration-500 "+(s||i?"mt-0 scale-95 opacity-0":"mt-8 scale-100 opacity-100"),children:[(0,p.jsxs)("div",{className:"relative flex h-4 w-32 items-center rounded border border-control px-2",children:[(0,p.jsx)("div",{className:"h-0.5 w-2/3 rounded-full bg-surface-300"}),(0,p.jsx)("div",{className:"absolute right-1 -bottom-4",children:(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})})})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,p.jsx)("h3",{className:"text-sm text-foreground",children:"Select an Event"}),(0,p.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Select an Event to view the code snippet (pretty view) or complete JSON payload (raw view)."})]})]})}),(0,p.jsxs)("div",{className:"relative h-px flex-grow bg-surface-100",children:[(0,p.jsxs)("div",{className:"pt-4 px-4 flex flex-col gap-4",children:[(0,p.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,p.jsx)("div",{className:"transition ".concat(i?"opacity-0":"opacity-100"),children:(0,p.jsx)(J.Z,{text:c,type:"default",title:"Copy log to clipboard"})}),(0,p.jsx)(j.z,{type:"text",className:"cursor-pointer transition hover:text-foreground h-8 w-8 px-0 py-0 flex items-center justify-center",onClick:n,children:(0,p.jsx)(V.Z,{size:14,strokeWidth:2,className:"text-foreground-lighter"})})]}),(0,p.jsx)("div",{className:"h-px w-full bg-selection rounded "})]}),i&&(0,p.jsx)(Q.Z,{}),(0,p.jsx)("div",{className:"flex flex-col space-y-6 bg-surface-100 py-4",children:!i&&(0,p.jsx)(()=>{switch(a){case"api":if(!l)return null;if(!l.metadata)return(0,p.jsx)(LogSelectionRenderers_DefaultPreviewSelectionRenderer,{log:l});return(0,p.jsx)(LogSelectionRenderers_DatabaseApiSelectionRender,{log:l});case"database":if(!l)return null;if(!l.metadata)return(0,p.jsx)(LogSelectionRenderers_DefaultPreviewSelectionRenderer,{log:l});return(0,p.jsx)(LogSelectionRenderers_DatabasePostgresSelectionRender,{log:l});case"fn_edge":if(!l)return null;if(!l.metadata)return(0,p.jsx)(LogSelectionRenderers_DefaultPreviewSelectionRenderer,{log:l});return(0,p.jsx)(LogSelectionRenderers_FunctionInvocationSelectionRender,{log:l});case"functions":if(!l)return null;if(!l.metadata)return(0,p.jsx)(LogSelectionRenderers_DefaultPreviewSelectionRenderer,{log:l});return(0,p.jsx)(LogSelectionRenderers_FunctionLogsSelectionRender,{log:l});case"auth":if(!l)return null;if(!l.metadata)return(0,p.jsx)(LogSelectionRenderers_DefaultPreviewSelectionRenderer,{log:l});return(0,p.jsx)(LogSelectionRenderers_AuthSelectionRenderer,{log:l});default:if(a&&l&&isDefaultLogPreviewFormat(l))return(0,p.jsx)(LogSelectionRenderers_DefaultPreviewSelectionRenderer,{log:l});if(a&&!l||!s)return null;return(0,p.jsx)(LogSelectionRenderers_DefaultExplorerSelectionRenderer,{log:s})}},{})})]})]})},ee=s(31915),LogsErrorRenderers_DefaultErrorRenderer=e=>{let{error:t}=e;return(0,p.jsx)(ee.Z.TextArea,{size:"tiny",value:"string"==typeof t?t:JSON.stringify(t,null,2),borderless:!0,className:"mt-4 w-full font-mono",copy:!0,rows:7})},et=s(34915),LogsErrorRenderers_ResourcesExceededErrorRenderer=e=>{let{error:t,isCustomQuery:s}=e;return(0,p.jsxs)("div",{className:"flex flex-col gap-2 text-foreground-light",children:[(0,p.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,p.jsx)("p",{children:"This query requires too much memory to be executed."}),(0,p.jsx)("p",{children:s?"Avoid selecting entire objects and instead select specific keys using dot notation.":"Avoid querying across a large datetime range."}),!s&&(0,p.jsx)("p",{children:"Please contact support if this error persists."})]}),(0,p.jsx)(et.Z,{className:"text-sm",justified:!1,openBehaviour:"multiple",type:"default",chevronAlign:"left",size:"small",iconPosition:"left",children:(0,p.jsx)(et.Z.Item,{id:"1",header:"Full error message",children:(0,p.jsx)(ee.Z.TextArea,{size:"tiny",value:JSON.stringify(t,null,2),borderless:!0,className:"mt-4 w-full font-mono",copy:!0,rows:5})})})]})},Logs_LogTable=e=>{let{data:t=[],queryType:s,onHistogramToggle:n,isHistogramShowing:a,isLoading:o,error:l,projectRef:i,params:c}=e,{ui:u}=(0,T.oR)(),[m,h]=(0,r.useState)(null),g=null==t?void 0:t[0],x=Object.keys(t[0]||{}),f=x.includes("id"),v=x.includes("timestamp"),b=x.map((e,t)=>({key:"logs-column-".concat(t),name:e,resizable:!0,renderCell:t=>{var s;let r=null===(s=t.row)||void 0===s?void 0:s[e];return r&&"object"==typeof r?JSON.stringify(r):null===r?"NULL":String(r)},renderHeaderCell:t=>e,minWidth:128})),y=b;if(s)switch(s){case"api":y=z;break;case"database":y=K;break;case"fn_edge":y=H;break;case"functions":y=X;break;case"auth":y=Y;break;default:y=g&&isDefaultLogPreviewFormat(g)?W:b}let _=JSON.stringify(t),[w,N]=(0,r.useMemo)(()=>{let e=[...new Set(t)];if(!f)return[e,{}];let s=e.reduce((e,t)=>(e[t.id]=t,e),{});return[e,s]},[_]);(0,r.useEffect)(()=>{if(!t)return;let e=t.find(e=>d()(e,m));e||h(null)},[_]);let S=(0,r.useMemo)(()=>f&&v?Object.values(N).sort((e,t)=>t.timestamp-e.timestamp):w,[_]),k=(0,r.useCallback)((e,t)=>(0,p.jsx)(D.X2,{...t,isRowSelected:!1,selectedCellIdx:void 0}),[]),copyResultsToClipboard=()=>{(0,G.vQ)(_,()=>{u.setNotification({category:"success",message:"Results copied to clipboard."})})};return t?(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("section",{className:"flex w-full flex-col "+(s?"":"shadow-lg"),style:{maxHeight:s?"calc(100vh - 42px - 3rem)":"calc(100vh - 42px - 10rem)"},children:[!s&&(0,p.jsx)(()=>(0,p.jsxs)("div",{className:"flex w-full items-center justify-between rounded-tl rounded-tr border-t border-l border-r bg-surface-100 px-5 py-2",children:[(0,p.jsx)("div",{className:"flex items-center gap-2",children:t&&t.length?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{className:"text-sm text-foreground",children:"Query results"}),(0,p.jsx)("span",{className:"text-sm text-foreground-light",children:t&&t.length})]}):(0,p.jsx)("span",{className:"text-xs text-foreground",children:"Results will be shown below"})}),(0,p.jsxs)("div",{className:"flex items-center gap-2",children:[n&&(0,p.jsx)(j.z,{type:"default",icon:a?(0,p.jsx)(F.Z,{}):(0,p.jsx)(q.Z,{}),onClick:n,children:"Histogram"}),(0,p.jsx)(j.z,{type:"default",icon:(0,p.jsx)(Z.Z,{}),onClick:copyResultsToClipboard,children:"Copy to clipboard"}),(0,p.jsx)(U.Z,{data:t,children:"Download"})]})]}),{}),(0,p.jsxs)("div",{className:"flex h-full flex-row ".concat(s?"":"border-l border-r"),children:[(0,p.jsx)(D.ZP,{style:{height:"100%"},className:"\n            flex-1 flex-grow\n            ".concat(s?" data-grid--simple-logs":"data-grid--logs-explorer","\n          "),rowHeight:40,headerRowHeight:s?0:28,onSelectedCellChange:e=>{let{rowIdx:s}=e;f&&h(t[s])},selectedRows:new Set([]),columns:y,rowClass:e=>["font-mono tracking-tight",d()(e,m)?"!bg-border-stronger rdg-row--focused":" !bg-background hover:!bg-surface-100 cursor-pointer"].join(" "),rows:S,rowKeyGetter:e=>f?e.id:JSON.stringify(e),renderers:{renderRow:k,noRowsFallback:o?null:(0,p.jsxs)("div",{className:"mx-auto flex h-full w-full items-center justify-center space-y-12 py-4 transition-all delay-200 duration-500",children:[!l&&(0,p.jsxs)("div",{className:"mt-16 flex scale-100 flex-col items-center justify-center gap-6 text-center opacity-100",children:[(0,p.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,p.jsx)("div",{className:"relative flex h-4 w-32 items-center rounded border border-dashed border-stronger px-2"}),(0,p.jsx)("div",{className:"relative flex h-4 w-32 items-center rounded border border-dashed border-stronger px-2",children:(0,p.jsx)("div",{className:"absolute right-1 -bottom-4 text-foreground-light",children:(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-1 px-5",children:[(0,p.jsx)("h3",{className:"text-lg text-foreground",children:"No results"}),(0,p.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Try another search, or adjusting the filters"})]})]}),l&&(()=>{var e;if(!l)return null;let t=LogsErrorRenderers_DefaultErrorRenderer;return"object"==typeof l&&(null===(e=l.error)||void 0===e?void 0:e.errors.find(e=>"resourcesExceeded"===e.reason))&&(t=LogsErrorRenderers_ResourcesExceededErrorRenderer),(0,p.jsx)("div",{className:"flex w-1/2 justify-center px-5",children:(0,p.jsx)(E.b,{variant:"danger",title:"Sorry! An error occurred when fetching data.",withIcon:!0,children:(0,p.jsx)(t,{isCustomQuery:!s,error:l})})})})()]})}}),S.length>0?(0,p.jsx)("div",{className:s?"flex w-1/2 flex-col":m?"flex w-1/2 flex-col":"hidden w-0",children:(0,p.jsx)(Logs_LogSelection,{projectRef:i,onClose:()=>h(null),log:m,queryType:s,params:c})}):null]})]})}):null},es=s(44534),Logs_LogEventChart=e=>{let{data:t,onBarClick:s}=e;return(0,p.jsx)(es.Z,{minimalHeader:!0,size:"tiny",yAxisKey:"count",xAxisKey:"timestamp",data:t,title:"Logs / Time",onBarClick:e=>{e.timestamp&&s(e.timestamp)},customDateFormat:"MMM D, HH:mm:s"})}},13392:function(e,t,s){s.d(t,{Z:function(){return ui_CSVButton}});var r=s(52322),n=s(94580),a=s(2784),o=s(38770),l=s(97265),IconDownloadCloud_IconDownloadCloud=function(e){return(0,r.jsx)(l.Z,{icon:o.Z,...e})},i=s(83606),ui_CSVButton=e=>{let{onClick:t,buttonType:s="default",icon:o,children:l,disabled:c,data:d,title:u}=e,m=(0,a.useRef)(null),handleDownload=()=>{var e;null===(e=m.current)||void 0===e||e.link.click()},h=(0,a.useMemo)(()=>{let e=null==d?void 0:d[0];if(!e||!d)return;let t=Object.keys(e);return d.map(e=>t.reduce((t,s)=>("object"==typeof e[s]?t[s]=JSON.stringify(e[s]):t[s]=String(e[s]),t),{}))},[JSON.stringify(d)]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.CSVLink,{ref:m,className:"hidden",data:h||[],filename:"supabase_logs.csv",title:u}),(0,r.jsx)(n.z,{type:s,icon:o||(0,r.jsx)(IconDownloadCloud_IconDownloadCloud,{}),disabled:c,onClick:e=>{t&&t(e),handleDownload()},children:l})]})}},44534:function(e,t,s){var r=s(52322),n=s(35767),a=s(28879),o=s.n(a),l=s(10264),i=s.n(l),c=s(2784),d=s(80739),u=s(25556),m=s(47857),h=s(24908),g=s(11011),x=s(90319),p=s(46899),f=s(32487);o().extend(i()),t.Z=e=>{var t,s;let{data:a,yAxisKey:l,xAxisKey:i,format:v,customDateFormat:j=n.EE.FULL,title:b,highlightedValue:y,highlightedLabel:_,displayDateInUtc:w,minimalHeader:N,valuePrecision:S,className:k="",size:R="normal",onBarClick:C}=e,{Container:E}=(0,p.D3)(R),[L,T]=(0,c.useState)(null);if(0===a.length)return(0,r.jsx)(f.Z,{size:R,className:k});let day=e=>w?o()(e).utc():o()(e),I=null!==L&&a&&void 0!==a[L]&&day(a[L][i]).format(j)||_,A=null!==L?null===(t=a[L])||void 0===t?void 0:t[l]:y;return(0,r.jsxs)("div",{className:["flex flex-col gap-3",k].join(" "),children:[(0,r.jsx)(x.Z,{title:b,format:v,customDateFormat:j,highlightedValue:"number"==typeof A?(0,p.V2)(A,S):A,highlightedLabel:I,minimalHeader:N}),(0,r.jsx)(E,{children:(0,r.jsxs)(d.v,{data:a,margin:{top:0,right:0,left:0,bottom:0},className:"overflow-visible",onMouseMove:e=>{e.activeTooltipIndex!==L&&T(e.activeTooltipIndex)},onMouseLeave:()=>T(null),onClick:e=>{var t,s;let r=null==e?void 0:null===(s=e.activePayload)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:t.payload;C&&C(r,e)},children:[(0,r.jsx)(u.K,{dataKey:i,interval:a.length-2,angle:0,tick:!1,axisLine:{stroke:n.ZE.AXIS},tickLine:{stroke:n.ZE.AXIS}}),(0,r.jsx)(m.u,{content:()=>null}),(0,r.jsx)(h.$,{dataKey:l,fill:n.ZE.GREEN_1,animationDuration:300,maxBarSize:48,children:null==a?void 0:a.map((e,t)=>(0,r.jsx)(g.b,{className:"transition-all duration-300 ".concat(C?"cursor-pointer":""),fill:L===t||null===L?n.ZE.GREEN_1:n.ZE.GREEN_2,enableBackground:12},"cell-".concat(t)))})]})}),a&&(0,r.jsxs)("div",{className:"text-foreground-lighter -mt-9 flex items-center justify-between text-xs",children:[(0,r.jsx)("span",{children:day(a[0][i]).format(j)}),(0,r.jsx)("span",{children:day(null===(s=a[(null==a?void 0:a.length)-1])||void 0===s?void 0:s[i]).format(j)})]})]})}},90319:function(e,t,s){var r=s(52322);t.Z=e=>{let{format:t,highlightedValue:s,highlightedLabel:n,title:a,minimalHeader:o=!1}=e,l=(0,r.jsx)("h3",{className:"text-foreground-lighter "+(o?"text-xs":"text-sm"),children:a}),i=(0,r.jsxs)("h5",{className:"text-foreground text-xl font-normal ".concat(o?"text-base":"text-2xl"),children:[void 0!==s&&String(s),(0,r.jsx)("span",{className:"text-lg",children:"function"==typeof t?t(s):t})]}),c=(0,r.jsx)("h5",{className:"text-foreground-lighter text-xs",children:n});return o?(0,r.jsxs)("div",{className:"flex flex-row items-center gap-x-4",style:{minHeight:"1.8rem"},children:[a&&l,(0,r.jsxs)("div",{className:"flex flex-row items-baseline gap-x-2",children:[void 0!==s&&i,c]})]}):(0,r.jsxs)("div",{className:"h-16",children:[a&&l,void 0!==s&&i,c]})}},35767:function(e,t,s){var r,n;s.d(t,{EE:function(){return r},FK:function(){return genStackColorScales},Ki:function(){return o},ZE:function(){return a}});let a={TICK:"hsl(var(--background-overlay-hover))",AXIS:"hsl(var(--background-overlay-hover))",GREEN_1:"hsl(var(--brand-default))",GREEN_2:"hsl(var(--brand-500))"},genStackColorScales=e=>e.map(e=>{var t;let s=null!==(t=({slate:11})[e])&&void 0!==t?t:9;return{lighter:"var(--colors-".concat(e).concat(s-1,")"),base:"var(--colors-".concat(e).concat(s,")"),darker:"var(--colors-".concat(e).concat(s+1,")")}}),o=["brand","slate","blue","yellow","indigo"];(n=r||(r={})).FULL="MMM D, YYYY, hh:mma",n.DATE_ONLY="MMM D, YYYY"},46899:function(e,t,s){s.d(t,{Bh:function(){return precisionFormatter},D3:function(){return useChartSize},Hx:function(){return timestampFormatter},V2:function(){return numberFormatter},ww:function(){return useStacked}});var r=s(52322),n=s(28879),a=s.n(n),o=s(2784),l=s(61660),i=s(35767),c=s(10264),d=s.n(c);a().extend(d());let numberFormatter=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return isFloat(e)?precisionFormatter(e,t):String(e)},isFloat=e=>String(e).includes("."),precisionFormatter=(e,t)=>{if(!isFloat(e))return String(e)+"."+"0".repeat(t);{let[s,r]=String(e).split(".");return s+"."+r.slice(0,t)}},timestampFormatter=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.EE.FULL,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s?a().utc(e).format(t):a()(e).format(t)},useChartSize=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tiny:76,small:96,normal:160,large:280},s=t[e],n=(0,o.useMemo)(()=>e=>{let{children:t}=e;return(0,r.jsx)(l.h,{height:s,minHeight:s,width:"100%",children:t})},[e]);return{Container:n,minHeight:s}},useStacked=e=>{let{data:t,xAxisKey:s,yAxisKey:r,stackKey:n,variant:a="values"}=e,l=(0,o.useMemo)(()=>{if(!t)return[];let e=t.reduce((e,t)=>{let a=t[s],o=t[r],l=t[n];return e[a]||(e[a]={}),e[a][l]=o,e},{}),a=Object.entries(e).map(e=>{let[t,r]=e;return{...r,[s]:Number.isNaN(Number(t))?t:Number(t)}});return a},[JSON.stringify(t)]),i=(0,o.useMemo)(()=>Object.keys(l[0]||{}).filter(e=>e!==s&&e!==r).sort(),[JSON.stringify(l[0]||{})]),c=(0,o.useMemo)(()=>{if("percentages"===a)return l.map(e=>{let t=Object.entries(e),s=t.filter(e=>{let[t,s]=e;return i.includes(t)}).reduce((e,t)=>{let[s,r]=t;return e+r},0);return t.reduce((e,t)=>{let[r,n]=t;return i.includes(r)?{...e,[r]:0!==n?n/s:0}:{...e,[r]:n}},{})})},[JSON.stringify(l)]);return{dataKeys:i,stackedData:l,percentagesStackedData:c}}},32487:function(e,t,s){var r=s(52322),n=s(83194),a=s(46899);t.Z=e=>{let{title:t="No data to show",message:s,className:o="",size:l}=e,{minHeight:i}=(0,a.D3)(l);return(0,r.jsxs)("div",{className:"border-control flex flex-grow w-full flex-col items-center justify-center space-y-2 border border-dashed text-center "+o,style:{minHeight:i+20},children:[(0,r.jsx)(n.Z,{className:"text-border-stronger"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-foreground-light text-xs",children:t}),s&&(0,r.jsx)("p",{className:"text-foreground-lighter text-xs",children:s})]})]})}},35322:function(e,t,s){var r=s(87612);t.Z=class{hasNext(){return this.lineNumber>=0||this.offset>=0}isFowardDQuote(){return!!this.hasForward()&&34===this.peekForward()}isNextDQuote(){return!!this.hasNext()&&34===this.peekNext()}isNextPeriod(){return!!this.hasNext()&&46===this.peekNext()}peekNext(){return this.offset<0?this.lineNumber>0?10:0:this._line.charCodeAt(this.offset)}hasForward(){return this.lineNumber<this._lines.length||this.offset<this._line.length}peekForward(){return this.offset===this._line.length?this.lineNumber===this._lines.length?0:10:this._line.charCodeAt(this.offset+1)}next(){if(this.offset<0)return this.lineNumber>0?(this.lineNumber--,this._line=this._lines[this.lineNumber],this.offset=this._line.length-1,10):(this.lineNumber=-1,0);let e=this._line.charCodeAt(this.offset);return this.offset--,e}readArguments(){let e=0,t=0,s=0,r=0;for(;this.hasNext();){let n=this.next();switch(n){case 40:if(--e<0)return r;break;case 41:e++;break;case 123:s--;break;case 125:s++;break;case 91:t--;break;case 93:t++;break;case 34:case 39:for(;this.hasNext()&&n!==this.next(););break;case 44:!e&&!t&&!s&&r++}}return -1}readIdent(){let e=!1,t=!1,s="";for(;this.hasNext();){let r=this.peekNext();if(e&&!t&&!this._isIdentPart(r))break;if(r=this.next(),!e&&t&&34===r){e=!0;continue}if(e||32!==r&&9!==r&&10!=r){if(!e&&(34===r||this._isIdentPart(r)))e=!0,t=34===r,s=String.fromCharCode(r)+s;else if(e){if(t){if(0===r||(s=String.fromCharCode(r)+s,34===r))break}else s=String.fromCharCode(r)+s}}}return s}readIdents(e){let t=[];for(;e>0;){e--;let s=this.readIdent();if(!s||(t.push(s),!this.isNextPeriod()))break}return t.reverse()}_isIdentPart(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57}constructor(e,t,s){(0,r._)(this,"_line",void 0),(0,r._)(this,"_text",void 0),(0,r._)(this,"_lines",void 0),(0,r._)(this,"model",void 0),(0,r._)(this,"offset",void 0),(0,r._)(this,"lineNumber",void 0),this.model=e,this.offset=t,this.lineNumber=s,this._text=e.getValue(),this._lines=this._text.split(/\r?\n/g),this._line=this._lines[s]}}},19776:function(e,t,s){var r=s(52322),n=s(94580),a=s(71813),o=s(49097),l=s(2784);t.Z=e=>{let{text:t,children:s,onClick:i,bounceIconOnCopy:c,...d}=e,[u,m]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(!u)return;let e=setTimeout(()=>m(!1),2e3);return()=>clearTimeout(e)},[u]),(0,r.jsx)(n.z,{onClick:e=>{m(!0),(0,a.vQ)(t),null==i||i(e)},icon:(0,r.jsx)(o.Z,{size:"tiny",className:[u&&c?"animate-bounce":"","transition"].join(" ")}),...d,children:null!=s?s:u?"Copied":"Copy"})}},34915:function(e,t,s){var r=s(52322),n=s(2784),a=s(53009),o=s(99176),l=s(43502);let i=(0,n.createContext)({chevronAlign:"left",justified:!0,type:"default"});function Accordion(e){let{children:t,className:s,onChange:n,openBehaviour:l="multiple",type:c="default",defaultValue:d,justified:u=!1,chevronAlign:m="left"}=e,h=(0,a.Z)("accordion"),g=[h.variants[c].base];return s&&g.push(s),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(o.fC,{type:l,onValueChange:function(e){n&&n(e),e==typeof String&&e.split(" ")},defaultValue:d,className:g.join(" "),children:(0,r.jsx)(i.Provider,{value:{chevronAlign:m,justified:u,type:c,defaultValue:d},children:(0,r.jsx)("div",{children:t})})})})}Accordion.Item=function(e){let{children:t,className:s,header:c,id:d,disabled:u}=e,m=(0,a.Z)("accordion"),[h,g]=(0,n.useState)(!1),{type:x,justified:p,chevronAlign:f}=(0,n.useContext)(i),v=[m.variants[x].trigger];p&&v.push(m.justified),s&&v.push(s);let j=[m.chevron.base,m.chevron.align[f]];return h&&!u&&j.unshift("!rotate-180"),(0,r.jsxs)(o.ck,{value:d,className:m.variants[x].container,disabled:u,onClick:()=>{g(!h)},children:[(0,r.jsxs)(o.xz,{className:v.join(" "),children:[c,!u&&(0,r.jsx)(l.Z,{"aria-hidden":!0,className:j.join(" "),strokeWidth:2})]}),(0,r.jsx)(o.VY,{className:m.variants[x].content,children:(0,r.jsx)("div",{className:m.variants[x].panel,children:t})})]})},t.Z=Accordion},83194:function(e,t,s){var r=s(52322);s(2784);var n=s(7342),a=s(97265);t.Z=function(e){return(0,r.jsx)(a.Z,{icon:n.Z,...e})}},32152:function(e,t,s){var r=s(52322);s(2784);var n=s(99792),a=s(97265);t.Z=function(e){return(0,r.jsx)(a.Z,{icon:n.Z,...e})}}}]);