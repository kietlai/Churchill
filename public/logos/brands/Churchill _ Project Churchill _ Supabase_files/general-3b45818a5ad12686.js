(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2281],{31458:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/general",function(){return s(54290)}])},26861:function(e,t,s){"use strict";s.d(t,{iN:function(){return FormActions},ph:function(){return FormHeader},by:function(){return FormPanel},hj:function(){return FormSection},B4:function(){return FormSectionContent},S0:function(){return FormSectionLabel},ld:function(){return FormsContainer}});var r=s(52322);function FormsContainer(e){return(0,r.jsxs)("div",{className:"mx-auto max-w-4xl px-5 pt-12 pb-20",children:[e.header&&(0,r.jsx)("h1",{className:"text-foreground mb-8 text-3xl",children:e.header}),(0,r.jsx)("div",{className:"space-y-20",children:e.children})]})}var a=s(39097),n=s.n(a),o=s(29071),i=s(94580),l=s(63157);let FormHeader=e=>{let{title:t,description:s,docsUrl:a}=e;return(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h3",{className:"text-foreground text-xl",children:(0,r.jsx)(o.D,{unwrapDisallowed:!0,disallowedElements:["p"],children:t})}),s&&(0,r.jsx)("div",{className:"text-foreground-lighter text-sm",children:(0,r.jsx)(o.D,{children:s})})]}),void 0!==a&&(0,r.jsx)(i.z,{asChild:!0,type:"default",icon:(0,r.jsx)(l.Z,{}),children:(0,r.jsx)(n(),{href:a,target:"_blank",rel:"noreferrer",children:"Documentation"})})]})};var c=s(2784);let FormSection=e=>{let{children:t,id:s,header:a,disabled:n,className:o}=e;return(0,r.jsxs)("div",{id:s,className:["grid grid-cols-12 gap-6 px-8 py-8","".concat(n?" opacity-30":" opacity-100"),"".concat(o)].join(" "),children:[a,t]})},FormSectionLabel=e=>{let{children:t,className:s="",description:a}=e;return void 0!==a?(0,r.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(s),children:[(0,r.jsx)("label",{className:"text-foreground text-sm",children:t}),a]}):(0,r.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(s),children:t})},Shimmer=()=>(0,r.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,r.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,r.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,r.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),FormSectionContent=e=>{let{children:t,loading:s=!0,fullWidth:a,className:n}=e;return(0,r.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(a&&"!col-span-12","\n        ").concat(n,"\n      "),children:s?c.Children.map(t,()=>(0,r.jsx)(Shimmer,{})):t})},FormPanel=e=>{let{children:t,header:s,footer:a}=e;return(0,r.jsxs)("div",{className:" bg-surface-100 border-default overflow-hidden  rounded-md border shadow",children:[s&&(0,r.jsx)("div",{className:"border-default border-b px-8 py-4",children:s}),(0,r.jsx)("div",{className:"divide-border flex flex-col gap-0 divide-y",children:t}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"border-default border-t"}),a]})]})},FormActions=e=>{let{form:t,hasChanges:s,handleReset:a,helper:n,disabled:o=!1,isSubmitting:l,submitText:c="Save"}=e,d=l||o||!s&&void 0!==s;return(0,r.jsxs)("div",{className:["flex w-full items-center gap-2",n?"justify-between":"justify-end"].join(" "),children:[n&&(0,r.jsx)("span",{className:"text-sm text-foreground-lighter",children:n}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(i.z,{disabled:d,type:"default",htmlType:"reset",onClick:()=>a(),children:"Cancel"}),(0,r.jsx)(i.z,{form:t,type:"primary",htmlType:"submit",disabled:d,loading:l,children:c})]})]})}},28590:function(e,t,s){"use strict";s.d(t,{S:function(){return useSendDowngradeFeedbackMutation}});var r=s(62350),a=s(62202),n=s(3218),o=s(46732);async function sendDowngradeFeedback(e){let{projectRef:t,orgSlug:s,reasons:r,message:a,exitAction:i}=e,l=await (0,n.v_)("".concat(o.T5,"/feedback/downgrade"),{...void 0!==t&&{projectRef:t},...void 0!==s&&{orgSlug:s},reasons:r,additionalFeedback:a,exitAction:i});if(l.error)throw l.error;return l}let useSendDowngradeFeedbackMutation=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.D)(e=>sendDowngradeFeedback(e),{async onError(t,s,r){void 0===e?a.ZP.error("Failed to submit exit survey: ".concat(t.message)):e(t,s,r)},...t})}},54290:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eb}});var r=s(52322),a=s(59491),n=s(39097),o=s.n(n),i=s(50074),l=s(39195),c=s(57463),d=s(31915),u=s(83194),m=s(94580),h=s(2755),x=s(26861),j=s(12744),p=s(20775),f=s(55830),g=s(62350),v=s(62202),b=s(3218),y=s(46732),N=s(31604);async function updateProject(e){let{ref:t,name:s}=e,r=await (0,b.r$)("".concat(y.T5,"/projects/").concat(t),{name:s});if(r.error)throw r.error;return r}let useProjectUpdateMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,f.NL)();return(0,g.D)(e=>updateProject(e),{async onSuccess(t,s,a){await r.invalidateQueries(N.i.list()),await (null==e?void 0:e(t,s,a))},async onError(e,s,r){void 0===t?v.Am.error("Failed to update project: ".concat(e.message)):t(e,s,r)},...s})};var w=s(89465),C=s(24990),P=s(5632),_=s(2784),D=s(950),S=s(97265),IconPause_IconPause=function(e){return(0,r.jsx)(S.Z,{icon:D.Z,...e})},k=s(1681),T=s(98050),A=s(9402);async function pauseProject(e){let{ref:t}=e,{data:s,error:r}=await (0,A.v_)("/platform/projects/{ref}/pause",{params:{path:{ref:t}}});if(r)throw r;return s}let useProjectPauseMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,g.D)(e=>pauseProject(e),{async onSuccess(t,s,r){await (null==e?void 0:e(t,s,r))},async onError(e,s,r){void 0===t?v.Am.error("Failed to pause project: ".concat(e.message)):t(e,s,r)},...s})};var Z=s(29659),z=s(21511),Infrastructure_PauseProjectButton=()=>{var e;let{ui:t}=(0,w.oR)(),s=(0,P.useRouter)(),n=(0,f.NL)(),{project:o}=(0,h.d2)(),i=(0,w.lL)(),l=(0,h.gY)(),[c,d]=(0,_.useState)(!1),u=null!==(e=null==o?void 0:o.ref)&&void 0!==e?e:"",x=(null==o?void 0:o.status)===y.S.INACTIVE,j=(0,w.Xo)(a.KA.INFRA_EXECUTE,"queue_jobs.projects.pause"),{data:p}=(0,z.G)({orgSlug:null==i?void 0:i.slug}),g=(null==p?void 0:p.plan.id)==="free",{mutate:v,isLoading:b}=useProjectPauseMutation({onSuccess:(e,r)=>{(0,Z.k7)(n,r.ref,y.S.PAUSING),t.setNotification({category:"success",message:"Pausing project..."}),s.push("/project/".concat(u))}}),N=!g||void 0===o||x||!j||!l;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.fC,{delayDuration:0,children:[(0,r.jsx)(C.xz,{asChild:!0,children:(0,r.jsx)(m.z,{type:"default",icon:(0,r.jsx)(IconPause_IconPause,{}),onClick:()=>d(!0),loading:b,disabled:N,children:"Pause Project"})}),N?(0,r.jsx)(C.h_,{children:(0,r.jsxs)(C.VY,{side:"bottom",children:[(0,r.jsx)(C.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:x?"Your project is already paused":j?l?g?"":"Projects on a paid plan will always be running":"Unable to pause project as project is not active":"You need additional permissions to pause this project"})})]})}):null]}),(0,r.jsx)(T.Z,{danger:!0,visible:c,loading:b,header:"Pause this project?",description:"",buttonLabel:"Pause project",buttonLoadingLabel:"Pausing project",onSelectCancel:()=>d(!1),onSelectConfirm:()=>{if(!j)return t.setNotification({category:"error",message:"You do not have the required permissions to pause this project"});v({ref:u})},children:(0,r.jsx)(k.C.Content,{className:"py-4",children:(0,r.jsx)("p",{className:"text-foreground-light text-sm",children:"Are you sure you want to pause this project? It will not be accessible until you unpause it."})})})]})},R=s(46776),L=s(97036),F=s(43502),E=s(33461);async function restartProject(e){let{ref:t}=e,{data:s,error:r}=await (0,A.v_)("/platform/projects/{ref}/restart",{params:{path:{ref:t}}});if(r)throw r;return s}let useProjectRestartMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,g.D)(e=>restartProject(e),{async onSuccess(t,s,r){await (null==e?void 0:e(t,s,r))},async onError(e,s,r){void 0===t?v.Am.error("Failed to restart project: ".concat(e.message)):t(e,s,r)},...s})};var M=s(935),I=(0,R.Pi)(()=>{var e,t;let{ui:s}=(0,w.oR)(),n=(0,P.useRouter)(),o=(0,f.NL)(),{project:i}=(0,h.d2)(),l=(0,h.gY)(),[c,d]=(0,_.useState)(),u=null!==(e=null==i?void 0:i.ref)&&void 0!==e?e:"",x=null!==(t=null==i?void 0:i.region)&&void 0!==t?t:"",j=(0,w.Xo)(a.KA.INFRA_EXECUTE,"reboot"),{mutate:p,isLoading:g}=useProjectRestartMutation({onSuccess:()=>{onRestartSuccess()},onError:e=>{onRestartFailed(e,"project")}}),{mutate:v,isLoading:b}=(0,M.D)({onSuccess:()=>{onRestartSuccess()},onError:e=>{onRestartFailed(e,"database")}}),requestProjectRestart=()=>{if(!j)return s.setNotification({category:"error",message:"You do not have the required permissions to restart this project"});p({ref:u})},requestDatabaseRestart=async()=>{if(!j)return s.setNotification({category:"error",message:"You do not have the required permissions to restart this project"});v({ref:u,region:x,services:["postgresql"]})},onRestartFailed=(e,t)=>{s.setNotification({error:e,category:"error",message:"Unable to restart ".concat(t,": ").concat(e.message)}),d(void 0)},onRestartSuccess=()=>{(0,Z.Ob)(o,u,"OFFLINE"),s.setNotification({category:"success",message:"Restarting server..."}),n.push("/project/".concat(u)),d(void 0)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.fC,{delayDuration:0,children:[(0,r.jsx)(C.xz,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m.z,{type:"default",className:"px-3 ".concat(j&&l?"rounded-r-none":""),disabled:void 0===i||!j||!l,onClick:()=>d("project"),children:"Restart project"}),j&&l&&(0,r.jsxs)(L.h_,{children:[(0,r.jsx)(L.$F,{asChild:!0,children:(0,r.jsx)(m.z,{type:"default",className:"rounded-l-none px-[4px] py-[5px]",icon:(0,r.jsx)(F.Z,{}),disabled:!j})}),(0,r.jsx)(L.AW,{align:"end",side:"bottom",children:(0,r.jsx)(L.Xi,{disabled:g||b,onClick:()=>{d("database")},children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"block text-foreground",children:"Fast database reboot"}),(0,r.jsx)("p",{className:"block text-foreground-light",children:"Restarts only the database - faster but may not be able to recover from all failure modes"})]})},"database")})]})]})}),void 0!==i&&(!j||!l)&&(0,r.jsx)(C.h_,{children:(0,r.jsxs)(C.VY,{side:"bottom",children:[(0,r.jsx)(C.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:j?l?"":"Unable to restart project as project is not active":"You need additional permissions to restart this project"})})]})})]}),(0,r.jsx)(E.Z,{danger:!0,visible:void 0!==c,title:"Restart ".concat(c),description:(0,r.jsxs)(r.Fragment,{children:["Are you sure you want to restart the"," ",(0,r.jsx)("span",{className:"text-foreground",children:c}),"? There will be a few minutes of downtime."]}),buttonLabel:"Restart",buttonLoadingLabel:"Restarting",onSelectCancel:()=>d(void 0),onSelectConfirm:async()=>{"project"===c?await requestProjectRestart():"database"===c&&await requestDatabaseRestart()}})]})}),General_General=()=>{var e,t;let{ui:s}=(0,w.oR)(),{project:n}=(0,h.d2)(),f=(0,w.lL)(),g=(0,w.N$)(null==n?void 0:n.parent_project_ref),v=void 0!==g,b="project-general-settings",y={name:null!==(e=null==n?void 0:n.name)&&void 0!==e?e:"",ref:null!==(t=null==n?void 0:n.ref)&&void 0!==t?t:""},N=(0,w.Xo)(a.KA.UPDATE,"projects",{resource:{project_id:null==n?void 0:n.id}}),{mutateAsync:C,isLoading:P}=useProjectUpdateMutation(),onSubmit=async(e,t)=>{let{resetForm:r}=t;if(!(null==n?void 0:n.ref))return console.error("Ref is required");try{let{name:t}=await C({ref:n.ref,name:e.name.trim()});r({values:{name:t},initialValues:{name:t}}),s.setNotification({category:"success",message:"Successfully saved settings"})}catch(e){}};return(0,r.jsxs)("div",{children:[(0,r.jsx)(x.ph,{title:"Project Settings",description:""}),v&&(0,r.jsxs)(i.bZ,{variant:"default",className:"mb-6",children:[(0,r.jsx)(l.Z,{strokeWidth:2}),(0,r.jsx)(i.Cd,{children:"You are currently on a preview branch of your project"}),(0,r.jsxs)(i.X,{children:["Certain settings are not available while you're on a preview branch. To adjust your project settings, you may return to your"," ",(0,r.jsx)(o(),{href:"/project/".concat(g.ref,"/settings/general"),className:"text-brand",children:"main branch"}),"."]})]}),void 0===n?(0,r.jsx)(p.A,{}):(0,r.jsx)(c.Z,{id:b,initialValues:y,onSubmit:onSubmit,children:e=>{let{handleReset:t,values:s,initialValues:a}=e,n=JSON.stringify(s)!==JSON.stringify(a);return(0,r.jsx)(x.by,{disabled:!N,footer:(0,r.jsx)("div",{className:"flex py-4 px-8",children:(0,r.jsx)(x.iN,{form:b,isSubmitting:P,hasChanges:n,handleReset:t,helper:N?void 0:"You need additional permissions to manage this project's settings"})}),children:(0,r.jsx)(x.hj,{header:(0,r.jsx)(x.S0,{children:"General settings"}),children:(0,r.jsxs)(x.B4,{loading:!1,children:[(0,r.jsx)(d.Z,{id:"name",size:"small",label:"Project name",disabled:v||!N}),(0,r.jsx)(d.Z,{copy:!0,disabled:!0,id:"ref",size:"small",label:"Reference ID"})]})})})}}),!v&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mt-6",id:"restart-project",children:(0,r.jsxs)(x.by,{children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between px-8 py-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",children:"Restart project"}),(0,r.jsx)("div",{className:"max-w-[420px]",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Your project will not be available for a few minutes."})})]}),(0,r.jsx)(I,{})]}),(0,r.jsxs)("div",{className:"flex w-full items-center justify-between px-8 py-4",id:"pause-project",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",children:"Pause project"}),(0,r.jsx)("div",{className:"max-w-[420px]",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Your project will not be accessible while it is paused."})})]}),(0,r.jsx)(Infrastructure_PauseProjectButton,{})]})]})}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(j.Z,{children:(0,r.jsx)(j.Z.Content,{children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)(u.Z,{strokeWidth:2}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",children:"Project usage statistics has been moved"}),(0,r.jsx)("p",{className:"text-foreground-light text-sm",children:"You may view your project's usage under your organization's settings"})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(m.z,{asChild:!0,type:"default",children:(0,r.jsx)(o(),{href:"/org/".concat(null==f?void 0:f.slug,"/usage?projectRef=").concat(null==n?void 0:n.ref),children:"View project usage"})})})]})})})})]})]})},Y=s(84959),q=s(73205),O=s(62528),IconPackage_IconPackage=function(e){return(0,r.jsx)(S.Z,{icon:O.Z,...e})},U=s(73872),X=s(50226),V=s(75641);(0,R.Pi)(e=>{var t;let{}=e,{ref:s}=(0,U.UO)(),{project:a}=(0,h.d2)(),n=(0,w.lL)(),{data:i}=(0,z.G)({orgSlug:null==n?void 0:n.slug}),l=(null==i?void 0:null===(t=i.plan)||void 0===t?void 0:t.id)==="free",{data:c,isLoading:u,isError:j}=(0,X.D)({projectRef:s}),{current_app_version:p,latest_app_version:f,requires_manual_intervention:g}=c||{},v=(null!=p?p:"").split("supabase-postgres-")[1],b=(null!=f?f:"").split("supabase-postgres-")[1],y=(0,w.P5)("databaseUpgrades"),N="Upgrade information:%0A• Manual intervention reason: ".concat(g);return(0,r.jsxs)("div",{children:[(0,r.jsx)(x.ph,{title:"Infrastructure",description:""}),(0,r.jsxs)(x.by,{footer:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between px-8 py-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",children:"Restart server"}),(0,r.jsx)("div",{className:"max-w-[420px]",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Your project will not be available for a few minutes."})})]}),a&&(0,r.jsx)(I,{})]}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"border-t border-muted"}),(0,r.jsxs)("div",{className:"flex w-full items-center justify-between px-8 py-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",children:"Pause project"}),(0,r.jsx)("div",{className:"max-w-[420px]",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Your project will not be accessible while it is paused."})})]}),a&&(0,r.jsx)(Infrastructure_PauseProjectButton,{})]})]})]}),children:[(0,r.jsx)(x.hj,{header:(0,r.jsx)(x.S0,{children:"Configuration"}),children:(0,r.jsxs)(x.B4,{loading:void 0===a,children:[(0,r.jsx)(d.Z,{readOnly:!0,disabled:!0,value:null==a?void 0:a.cloud_provider,label:"Cloud provider"}),(0,r.jsx)(d.Z,{readOnly:!0,disabled:!0,value:null==a?void 0:a.region,label:"Region"})]})}),(0,r.jsx)(x.hj,{header:(0,r.jsx)(x.S0,{children:"Postgres"}),children:(0,r.jsxs)(x.B4,{loading:u,children:[(0,r.jsx)(d.Z,{readOnly:!0,disabled:!0,value:null!=v?v:j?"Unable to fetch Postgres version of project":"",label:"Current version",actions:[p===f&&(0,r.jsxs)(C.fC,{delayDuration:0,children:[(0,r.jsx)(C.xz,{children:(0,r.jsx)(Y.Z,{color:"green",className:"mr-1",children:"Latest"})}),(0,r.jsx)(C.h_,{children:(0,r.jsxs)(C.VY,{side:"bottom",children:[(0,r.jsx)(C.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background w-[200px]",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:"Project is on the latest version of Postgres that Supabase supports"})})]})})]})]}),y&&(null==c?void 0:c.eligible)&&(0,r.jsx)(V.Z,{}),y&&!(null==c?void 0:c.eligible)&&(null==c?void 0:c.requires_manual_intervention)&&(0,r.jsxs)(q.b,{icon:(0,r.jsx)(IconPackage_IconPackage,{className:"text-foreground-light",strokeWidth:1.5}),variant:"neutral",title:"A new version of Postgres is available for your project",children:[(0,r.jsxs)("p",{className:"mb-3",children:["Please reach out to us via our support form if you are keen to upgrade your Postgres version to the latest available (",b,")."]}),(0,r.jsx)(m.z,{asChild:!0,size:"tiny",type:"default",children:(0,r.jsx)(o(),{href:"/support/new?category=Database_unresponsive&ref=".concat(s,"&subject=").concat("Request%20for%20Postgres%20upgrade%20for%20project","&message=").concat(N),target:"_blank",rel:"noreferrer",children:"Contact support"})})]})]})})]})]})});var W=s(93444),B=s(25544),G=s(13813),Q=s(63157);async function checkCNAMERecord(e){let{domain:t}=e,s=await fetch("https://1.1.1.1/dns-query?name=".concat(t,"&type=CNAME"),{method:"GET",headers:{accept:"application/dns-json"}}),r=await s.json();if(void 0===r.Answer)throw Error("Your CNAME record for ".concat(t," cannot be found - if you've just added the record, do check back in a bit."));return r.Answer.some(e=>5===e.type)}let useCheckCNAMERecordMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,g.D)(e=>checkCNAMERecord(e),{async onSuccess(t,s,r){await (null==e?void 0:e(t,s,r))},async onError(e,s,r){void 0===t?v.ZP.error("Failed to check CNAME record: ".concat(e.message)):t(e,s,r)},...s})};var K=s(50913);async function activateCustomDomain(e){let{projectRef:t}=e,{data:s,error:r}=await (0,A.v_)("/v1/projects/{ref}/custom-hostname/activate",{params:{path:{ref:t}}});if(r)throw r;return s}let useCustomDomainActivateMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,f.NL)();return(0,g.D)(e=>activateCustomDomain(e),{async onSuccess(t,s,a){let{projectRef:n}=s;await r.invalidateQueries(K.A.list(n)),await (null==e?void 0:e(t,s,a))},async onError(e,s,r){void 0===t?v.ZP.error("Failed to activate custom domain: ".concat(e.message)):t(e,s,r)},...s})};async function deleteCustomDomain(e){let{projectRef:t}=e,{data:s,error:r}=await (0,A.IV)("/v1/projects/{ref}/custom-hostname",{params:{path:{ref:t}}});if(r)throw r;return s}let useCustomDomainDeleteMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,f.NL)();return(0,g.D)(e=>deleteCustomDomain(e),{async onSuccess(t,s,a){let{projectRef:n}=s;r.setQueriesData(K.A.list(n),()=>({customDomain:null,status:"0_no_hostname_configured"})),await (null==e?void 0:e(t,s,a))},async onError(e,s,r){void 0===t?v.Am.error("Failed to delete custom domain: ".concat(e.message)):t(e,s,r)},...s})};var $=(0,R.Pi)(e=>{let{projectRef:t,customDomain:s}=e,{ui:a}=(0,w.oR)(),[n,c]=(0,_.useState)(!1),{data:d}=(0,B.q)({projectRef:t}),{mutate:u,isLoading:h}=useCheckCNAMERecordMutation(),{mutate:x,isLoading:p}=useCustomDomainActivateMutation({onSuccess:()=>{a.setNotification({category:"success",message:"Successfully activated custom domain"}),c(!1)}}),{mutate:f,isLoading:g}=useCustomDomainDeleteMutation(),v=null==d?void 0:d.autoApiService.endpoint,onActivateCustomDomain=async()=>{if(!t)return console.error("Project ref is required");u({domain:s.hostname},{onSuccess:()=>x({projectRef:t})})},onCancelCustomDomain=async()=>{if(!t)return console.error("Project ref is required");f({projectRef:t})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col items-start",children:[(0,r.jsxs)(j.Z.Content,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("h4",{className:"text-foreground",children:["Setup complete! Press activate to enable the custom domain"," ",(0,r.jsx)("code",{className:"text-sm",children:s.hostname})," for this project."]}),(0,r.jsx)("span",{className:"text-sm text-foreground-light",children:"We recommend that you schedule a downtime window of 20 - 30 minutes for your application, as you will need to update any services that need to know about your custom domain (e.g client side code or OAuth providers)"})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)(i.bZ,{children:[(0,r.jsx)(l.Z,{className:"text-foreground-light",strokeWidth:1.5}),(0,r.jsx)(i.Cd,{children:"Remember to restore the original CNAME record from the first step before activating"}),(0,r.jsx)(i.X,{children:(0,r.jsxs)("p",{className:"col-span-12 text-sm lg:col-span-7 leading-6",children:["Set up a CNAME record for ",(0,r.jsx)("code",{className:"text-xs",children:s.hostname}),", resolving to"," ",v?(0,r.jsx)("code",{className:"text-xs",children:v}):"your project's API URL",", with as low a TTL as possible. If you're using Cloudflare as your DNS provider, disable the proxy option."]})})]})})]}),(0,r.jsx)("div",{className:"w-full border-t border-muted"}),(0,r.jsx)(j.Z.Content,{className:"w-full",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(m.z,{asChild:!0,type:"default",icon:(0,r.jsx)(Q.Z,{}),children:(0,r.jsx)(o(),{href:"https://supabase.com/docs/guides/platform/custom-domains",target:"_blank",rel:"noreferrer",children:"Documentation"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.z,{type:"default",onClick:onCancelCustomDomain,loading:g,disabled:g,className:"self-end",children:"Cancel"}),(0,r.jsx)(m.z,{icon:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"})}),disabled:g,onClick:()=>c(!0),className:"self-end",children:"Activate"})]})]})})]}),(0,r.jsx)(T.Z,{size:"small",loading:h||p,visible:n,header:(0,r.jsxs)("div",{children:["Are you sure you want to activate the custom domain"," ",(0,r.jsx)("code",{className:"text-sm",children:s.hostname})," for the project?"]}),buttonLabel:"Activate",buttonLoadingLabel:"Activating",onSelectCancel:()=>c(!1),onSelectConfirm:onActivateCustomDomain,children:(0,r.jsx)(k.C.Content,{className:"py-3",children:(0,r.jsx)("p",{className:"text-sm",children:"The existing Supabase subdomain will be deactivated."})})})]})}),J=s(5099),H=(0,R.Pi)(e=>{let{projectRef:t,customDomain:s}=e,{ui:a}=(0,w.oR)(),[n,i]=(0,_.useState)(!1),{mutate:l}=useCustomDomainDeleteMutation({onSuccess:()=>{a.setNotification({category:"success",message:"Successfully deleted custom domain"}),i(!1)}}),onDeleteCustomDomain=async()=>{if(!t)return console.error("Project ref is required");l({projectRef:t})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Z.Content,{children:(0,r.jsxs)("div",{className:"w-full space-y-2",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Active custom domain:"}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("code",{className:"text-lg mx-0 flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"h-2 w-2 rounded-full bg-brand"}),(0,r.jsx)("span",{children:s.hostname})]})}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Your custom domain is currently active and is serving traffic"})]})}),(0,r.jsx)("div",{className:"w-full border-t border-muted"}),(0,r.jsx)(j.Z.Content,{className:"w-full",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(m.z,{asChild:!0,type:"default",icon:(0,r.jsx)(Q.Z,{}),children:(0,r.jsx)(o(),{href:"https://supabase.com/docs/guides/platform/custom-domains",target:"_blank",rel:"noreferrer",children:"Documentation"})}),(0,r.jsx)(m.z,{type:"danger",icon:(0,r.jsx)(J.Z,{}),onClick:()=>i(!0),children:"Delete Custom Domain"})]})}),(0,r.jsx)(E.Z,{danger:!0,visible:n,title:(0,r.jsxs)("div",{children:["Are you sure you want to delete the custom domain"," ",(0,r.jsx)("code",{className:"text-sm",children:s.hostname})," for the project?"]}),description:"Your custom domain will be deactivated. You will need to re-verify your domain if you want to use it again.",buttonLabel:"Delete",buttonLoadingLabel:"Deleting",onSelectCancel:()=>i(!1),onSelectConfirm:onDeleteCustomDomain})]})}),ee=s(60674),et=s(65413);async function createCustomDomain(e){let{projectRef:t,customDomain:s}=e,{data:r,error:a}=await (0,A.v_)("/v1/projects/{ref}/custom-hostname/initialize",{params:{path:{ref:t}},body:{custom_hostname:s}});if(a)throw a;return r}let useCustomDomainCreateMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,f.NL)();return(0,g.D)(e=>createCustomDomain(e),{async onSuccess(t,s,a){let{projectRef:n}=s;await r.invalidateQueries(K.A.list(n)),await (null==e?void 0:e(t,s,a))},async onError(e,s,r){void 0===t?v.Am.error("Failed to create custom domain: ".concat(e.message)):t(e,s,r)},...s})},es=et.object({domain:et.string().required("A value for your custom domain is required")});var er=(0,R.Pi)(()=>{let{ref:e}=(0,ee.UO)(),{project:t}=(0,h.d2)(),{mutate:s,isLoading:n}=useCheckCNAMERecordMutation(),{mutate:i,isLoading:l}=useCustomDomainCreateMutation(),{data:u}=(0,B.q)({projectRef:e}),j="custom-domains-form",p=null==u?void 0:u.autoApiService.endpoint,f=(0,w.Xo)(a.KA.UPDATE,"projects",{resource:{project_id:null==t?void 0:t.id}}),onCreateCustomDomain=async t=>{if(!e)return console.error("Project ref is required");s({domain:t.domain},{onSuccess:()=>{i({projectRef:e,customDomain:t.domain})}})};return(0,r.jsx)(c.Z,{id:j,initialValues:{domain:""},validationSchema:es,onSubmit:onCreateCustomDomain,children:e=>{let{handleReset:t,values:s,initialValues:a}=e,i=JSON.stringify(s)!==JSON.stringify(a);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(x.by,{disabled:!f,footer:(0,r.jsx)("div",{className:"flex py-4 px-8",children:(0,r.jsx)(x.iN,{form:j,isSubmitting:n||l,submitText:"Add",hasChanges:i,handleReset:t,disabled:!1,helper:f?(0,r.jsx)(m.z,{asChild:!0,type:"default",icon:(0,r.jsx)(Q.Z,{}),children:(0,r.jsx)(o(),{href:"https://supabase.com/docs/guides/platform/custom-domains",target:"_blank",rel:"noreferrer",children:"Documentation"})}):"You need additional permissions to update your project's custom domain settings"})}),children:[(0,r.jsx)(x.hj,{header:(0,r.jsx)(x.S0,{children:"Add a custom domain"}),children:(0,r.jsx)(x.B4,{loading:!1,children:(0,r.jsx)(d.Z,{id:"domain",disabled:!f,className:"w-full",type:"text",name:"domain",placeholder:"subdomain.example.com"})})}),(0,r.jsx)(x.hj,{header:(0,r.jsx)(x.S0,{children:"Configure a CNAME record"}),children:(0,r.jsxs)("p",{className:"col-span-12 text-sm lg:col-span-7 leading-6",children:["Set up a CNAME record for"," ",s.domain?(0,r.jsx)("code",{className:"text-xs",children:s.domain}):"your custom domain",", resolving to"," ",p?(0,r.jsx)("code",{className:"text-xs",children:p}):"your project's API URL",", with as low a TTL as possible. If you're using Cloudflare as your DNS provider, disable the proxy option."]})})]})})}})}),CustomDomainConfig_CustomDomainsShimmerLoader=()=>(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-6 px-8 py-8",children:[(0,r.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,r.jsx)("div",{className:"h-6 w-1/3 bg-foreground-lighter rounded shimmering-loader"})}),(0,r.jsx)("div",{className:"col-span-12 lg:col-span-7",children:(0,r.jsx)("div",{className:"h-[38px] w-full bg-foreground-lighter rounded shimmering-loader"})})]}),ea=s(99750),en=s(72275);async function reverifyCustomDomain(e){let{projectRef:t}=e,{data:s,error:r}=await (0,A.v_)("/v1/projects/{ref}/custom-hostname/reverify",{params:{path:{ref:t}}});if(r)throw r;return s}let useCustomDomainReverifyMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,f.NL)();return(0,g.D)(e=>reverifyCustomDomain(e),{async onSuccess(t,s,a){let{projectRef:n}=s;await r.invalidateQueries(K.A.list(n)),await (null==e?void 0:e(t,s,a))},async onError(e,s,r){void 0===t?v.Am.error("Failed to reverify custom domain: ".concat(e.message)):t(e,s,r)},...s})};var CustomDomainConfig_DNSRecord=e=>{let{type:t,name:s,value:a}=e;return(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsx)("div",{className:"w-[50px]",children:(0,r.jsx)("p",{className:"font-mono text-base",children:t.toUpperCase()})}),(0,r.jsx)(d.Z,{readOnly:!0,copy:!0,disabled:!0,className:"input-mono flex-1",value:s,layout:"vertical"}),(0,r.jsx)(d.Z,{readOnly:!0,copy:!0,disabled:!0,className:"input-mono flex-1",value:a,layout:"vertical"})]})},eo=(0,R.Pi)(e=>{var t,s,a,n,c;let{projectRef:d,customDomain:u,settings:h}=e,[x,p]=(0,_.useState)(!1),{mutate:f,isLoading:g}=useCustomDomainReverifyMutation({onSuccess:e=>{"2_initiated"===e.status&&p(!0)}}),{mutate:v,isLoading:b}=useCustomDomainDeleteMutation(),y=null===(t=u.ssl.validation_errors)||void 0===t?void 0:t.reduce((e,t)=>e||t.message.includes("caa_error"),!1),onCancelCustomDomain=async()=>{if(!d)return console.error("Project ref is required");v({projectRef:d})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(j.Z.Content,{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-foreground mb-2",children:["Configure TXT verification for your custom domain"," ",(0,r.jsx)("code",{className:"text-sm",children:u.hostname})]}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Set the following TXT record(s) in your DNS provider, then click verify to confirm your control over the domain"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Records which have been successfully verified will be removed from this list below."}),(0,r.jsx)("div",{className:"mt-4 mb-2",children:(0,r.jsxs)(i.bZ,{variant:"default",children:[x?(0,r.jsx)(l.Z,{className:"text-foreground-light",strokeWidth:1.5}):(0,r.jsx)(ea.Z,{className:"text-foreground-light",strokeWidth:1.5}),(0,r.jsx)(i.Cd,{children:x?"Unable to verify records from DNS provider yet.":"Please note that it may take up to 24 hours for the DNS records to propagate."}),(0,r.jsx)(i.X,{children:x?(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{children:"Please check again soon. Note that it may take up to 24 hours for changes in DNS records to propagate."}),(0,r.jsxs)("p",{children:["You may also visit"," ",(0,r.jsx)(o(),{href:"https://whatsmydns.net/#TXT/".concat(u.hostname),className:"text-brand",children:"here"})," ","to check if your DNS has been propagated successfully before clicking verify."]}),(0,r.jsx)("p",{children:"Some registrars will require you to remove the domain name when creating DNS records. As an example, to create a record for `foo.app.example.com`, you would need to create an entry for `foo.app`."})]}):(0,r.jsxs)("p",{children:["You may also visit"," ",(0,r.jsx)(o(),{href:"https://whatsmydns.net/#TXT/".concat(u.hostname),className:"text-brand",children:"here"})," ","to check if your DNS has been propagated successfully before clicking verify."]})})]})})]}),y&&(0,r.jsxs)(q.b,{withIcon:!0,variant:"warning",title:"Certificate Authority Authentication (CAA) error",children:['Please add a CAA record allowing "digicert.com" to issue certificates for'," ",(0,r.jsx)("code",{className:"text-xs",children:u.hostname}),". For example:"," ",(0,r.jsx)("code",{className:"text-xs",children:'0 issue "digicert.com"'})]}),"validation_timed_out"===u.ssl.status?(0,r.jsx)(q.b,{withIcon:!0,variant:"warning",title:"Validation timed out",children:'Please click "Verify" again to retry the validation of the records'}):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-[50px]",children:(0,r.jsx)("p",{className:"text-foreground-light text-sm",children:"Type"})}),(0,r.jsx)("div",{className:"text-sm grid gap-2 md:grid md:grid-cols-12 md:gap-x-4 input-mono flex-1",children:(0,r.jsx)("div",{className:"flex flex-row space-x-2 justify-between col-span-12",children:(0,r.jsx)("label",{className:"block text-foreground-light text-sm break-all",children:"Name"})})}),(0,r.jsx)("div",{className:"text-sm grid gap-2 md:grid md:grid-cols-12 md:gap-x-4 input-mono flex-1",children:(0,r.jsx)("div",{className:"flex flex-row space-x-2 justify-between col-span-12",children:(0,r.jsx)("label",{className:"block text-foreground-light text-sm break-all",children:"Content"})})})]}),(null===(s=u.verification_errors)||void 0===s?void 0:s.includes("custom hostname does not CNAME to this zone."))&&(0,r.jsx)(CustomDomainConfig_DNSRecord,{type:"CNAME",name:u.hostname,value:null!==(a=null==h?void 0:h.autoApiService.endpoint)&&void 0!==a?a:"Loading..."}),u.ownership_verification&&(0,r.jsx)(CustomDomainConfig_DNSRecord,{type:u.ownership_verification.type,name:u.ownership_verification.name,value:u.ownership_verification.value}),"pending_validation"===u.ssl.status&&(0,r.jsx)(CustomDomainConfig_DNSRecord,{type:"TXT",name:null!==(n=u.ssl.txt_name)&&void 0!==n?n:"Loading...",value:null!==(c=u.ssl.txt_value)&&void 0!==c?c:"Loading..."}),"pending_deployment"===u.ssl.status&&(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 py-8",children:[(0,r.jsx)(l.Z,{size:16,strokeWidth:1.5}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"SSL certificate is being deployed. Please wait a few minutes and try again."})]})]}),(0,r.jsxs)("div",{className:"!mt-4",children:[(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["One of the records requires you to"," ",(0,r.jsx)("span",{className:"text-foreground-light",children:"replace"})," the CNAME record set up in the first step with a TXT record."]}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"You'll be able to restore it back to the CNAME after the verification process has been completed."})]})]}),(0,r.jsx)("div",{className:"border-t border-muted"}),(0,r.jsx)(j.Z.Content,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(m.z,{asChild:!0,type:"default",icon:(0,r.jsx)(Q.Z,{}),children:(0,r.jsx)(o(),{href:"https://supabase.com/docs/guides/platform/custom-domains",target:"_blank",rel:"noreferrer",children:"Documentation"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.z,{type:"default",onClick:onCancelCustomDomain,loading:b,disabled:b||g,className:"self-end",children:"Cancel"}),(0,r.jsx)(m.z,{icon:(0,r.jsx)(en.Z,{}),onClick:()=>{if(!d)return console.error("Project ref is required");f({projectRef:d})},loading:g,disabled:b||g,className:"self-end",children:"Verify"})]})]})})]})}),CustomDomainConfig_CustomDomainConfig=()=>{var e;let{ref:t}=(0,U.UO)(),s=(0,w.lL)(),{data:a}=(0,z.G)({orgSlug:null==s?void 0:s.slug}),n=null==a?void 0:null===(e=a.plan)||void 0===e?void 0:e.id,{isLoading:i,data:c}=(0,B.q)({projectRef:t}),{isLoading:d,isError:u,isSuccess:m,data:h}=(0,G.z)({projectRef:t});return(0,r.jsxs)("section",{id:"custom-domains",children:[(0,r.jsx)(x.ph,{title:"Custom Domains",description:"Present a branded experience to your users"}),i||d?(0,r.jsx)(j.Z,{children:(0,r.jsx)(j.Z.Content,{className:"space-y-6",children:(0,r.jsx)(CustomDomainConfig_CustomDomainsShimmerLoader,{})})}):u?(0,r.jsx)(j.Z,{children:(0,r.jsx)(j.Z.Content,{className:"space-y-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 py-8",children:[(0,r.jsx)(l.Z,{size:16,strokeWidth:1.5}),(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["Failed to retrieve custom domain configuration. Please try again later or"," ",(0,r.jsx)(o(),{href:"/support/new?ref=".concat(t,"&category=sales"),className:"underline",children:"contact support"}),"."]})]})})}):(null==h?void 0:h.status)==="0_no_hostname_configured"?(0,r.jsx)(er,{}):(null==h?void 0:h.status)==="0_not_allowed"?(0,r.jsx)(W.Z,{icon:(0,r.jsx)(l.Z,{size:18,strokeWidth:1.5}),primaryText:"Custom domains are a Pro plan add-on",projectRef:t,organizationSlug:s.slug,secondaryText:"free"===n?"To configure a custom domain for your project, please upgrade to the Pro plan with the custom domains add-on selected":"To configure a custom domain for your project, please enable the add-on",addon:"customDomain"}):(0,r.jsx)(j.Z,{children:m&&(0,r.jsxs)("div",{className:"flex flex-col",children:[("1_not_started"===h.status||"2_initiated"===h.status||"3_challenge_verified"===h.status)&&(0,r.jsx)(eo,{projectRef:t,customDomain:h.customDomain,settings:c}),"4_origin_setup_completed"===h.status&&(0,r.jsx)($,{projectRef:t,customDomain:h.customDomain}),"5_services_reconfigured"===h.status&&(0,r.jsx)(H,{projectRef:t,customDomain:h.customDomain})]})})]})},ei=s(56995),el=s(7765),ec=s(28590);async function deleteProject(e){let{projectRef:t}=e,s=await (0,b.$v)("".concat(y.T5,"/projects/").concat(t));if(s.error)throw s.error;return s}let useProjectDeleteMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,f.NL)();return(0,g.D)(e=>deleteProject(e),{async onSuccess(t,s,a){await r.invalidateQueries(N.i.list()),await (null==e?void 0:e(t,s,a))},async onError(e,s,r){void 0===t?v.Am.error("Failed to delete project: ".concat(e.message)):t(e,s,r)},...s})};var DeleteProjectPanel_DeleteProjectButton=e=>{var t,s;let{type:n="danger"}=e,o=(0,P.useRouter)(),{ui:i}=(0,w.oR)(),{project:l}=(0,h.d2)(),c=(0,w.lL)(),u=null==l?void 0:l.ref,{data:x}=(0,z.G)({orgSlug:null==c?void 0:c.slug}),j=null!==(s=null==x?void 0:null===(t=x.plan)||void 0===t?void 0:t.id)&&void 0!==s?s:"free",p="free"===j,[f,g]=(0,_.useState)(!1),[v,b]=(0,_.useState)(""),[y,N]=(0,_.useState)([]),{mutateAsync:D,isLoading:S}=useProjectDeleteMutation(),{mutateAsync:k,isLoading:T}=(0,ec.S)(),A=S||T;(0,_.useEffect)(()=>{f&&(N([]),b(""))},[f]);let Z=(0,w.Xo)(a.KA.UPDATE,"projects",{resource:{project_id:null==l?void 0:l.id}}),toggle=()=>{A||g(!f)},onSelectCancellationReason=e=>{let t=y.find(t=>t===e),s=void 0===t?y.concat([e]):y.filter(t=>t!==e);N(s)};async function handleDeleteProject(){if(void 0!==l){if(!p&&0===y.length)return i.setNotification({category:"error",duration:4e3,message:"Please select at least one reason for deleting your project"});await D({projectRef:l.ref}),p||await k({projectRef:u,message:v,reasons:y.reduce((e,t)=>"".concat(e,"- ").concat(t,"\n"),""),exitAction:"delete"}),i.setNotification({category:"success",message:"Successfully deleted ".concat(l.name)}),o.push("/projects")}}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.fC,{delayDuration:0,children:[(0,r.jsx)(C.xz,{asChild:!0,children:(0,r.jsx)(m.z,{onClick:toggle,type:n,disabled:!Z,children:"Delete project"})}),!Z&&(0,r.jsx)(C.h_,{children:(0,r.jsxs)(C.VY,{side:"bottom",children:[(0,r.jsx)(C.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to delete this project"})})]})})]}),(0,r.jsx)(el.Z,{visible:f,loading:A,size:p?"small":"xlarge",title:"Confirm deletion of ".concat(null==l?void 0:l.name),alert:p?"This action cannot be undone.":"This will permanently delete the ".concat(null==l?void 0:l.name," project and all of its data, and cannot be undone"),text:p?"This will permanently delete the ".concat(null==l?void 0:l.name," project and all of its data."):void 0,confirmPlaceholder:"Type the project name in here",confirmString:(null==l?void 0:l.name)||"",confirmLabel:"I understand, delete this project",onConfirm:handleDeleteProject,onCancel:toggle,children:!p&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h4",{className:"text-base",children:"We're sad that you're leaving."}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"We always strive to improve Supabase as much as we can. Please let us know the reasons you are deleting your project so that we can improve in the future."})]}),(0,r.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:ei.Y.map(e=>{let t=y.find(t=>t===e);return(0,r.jsxs)("label",{className:["flex cursor-pointer items-center space-x-2 rounded-md py-1","pl-2 pr-3 text-center text-sm shadow-sm transition-all duration-100","".concat(t?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50")].join(" "),children:[(0,r.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:e=>onSelectCancellationReason(e.target.value)}),(0,r.jsx)("div",{children:e})]},e)})}),(0,r.jsx)("div",{className:"text-area-text-sm",children:(0,r.jsx)(d.Z.TextArea,{name:"message",label:"Anything else that we can improve on?",rows:3,value:v,onChange:e=>b(e.target.value)})})]})]})})]})},DeleteProjectPanel_DeleteProjectPanel=()=>{let{project:e}=(0,h.d2)();return void 0===e?null:(0,r.jsxs)("section",{id:"delete-project",children:[(0,r.jsx)(x.ph,{title:"Delete Project",description:""}),(0,r.jsx)(j.Z,{children:(0,r.jsx)(j.Z.Content,{children:(0,r.jsx)(q.b,{variant:"danger",withIcon:!0,title:"Deleting this project will also remove your database.",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"mb-4 block",children:"Make sure you have made a backup if you want to keep your data."}),(0,r.jsx)(DeleteProjectPanel_DeleteProjectButton,{})]})})})})]})},ed=s(13781),eu=s(283),em=s(54413),eh=s(60240),ex=s(47048),ej=s(1794),ep=s(22634);async function transferProject(e){let{projectRef:t,targetOrganizationSlug:s}=e;if(!t)throw Error("projectRef is required");if(!s)throw Error("targetOrganizationSlug is required");let r=await (0,b.v_)("".concat(y.T5,"/projects/").concat(t,"/transfer"),{target_organization_slug:s});if(r.error)throw r.error;return r}let useProjectTransferMutation=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,f.NL)();return(0,g.D)(e=>transferProject(e),{async onSuccess(t,s,a){let{projectRef:n,targetOrganizationSlug:o}=s;await Promise.all([r.invalidateQueries(N.i.projectTransferPreview(n,o)),r.invalidateQueries(N.i.detail(n)),r.invalidateQueries(N.i.list())]),await (null==e?void 0:e(t,s,a))},async onError(e,s,r){void 0===t?v.Am.error("Failed to transfer project: ".concat(e.message)):t(e,s,r)},...s})};var ef=s(58943);async function previewProjectTransfer(e,t){let{projectRef:s,targetOrganizationSlug:r}=e;if(!s)throw Error("projectRef is required");if(!r)throw Error("targetOrganizationSlug is required");let a=await (0,b.v_)("".concat(y.T5,"/projects/").concat(s,"/transfer/preview"),{target_organization_slug:r},{signal:t});if(a.error)throw a.error;return a}let useProjectTransferPreviewQuery=function(e){let{projectRef:t,targetOrganizationSlug:s}=e,{enabled:r=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ef.a)(N.i.projectTransferPreview(t,s),e=>{let{signal:r}=e;return previewProjectTransfer({projectRef:t,targetOrganizationSlug:s},r)},{enabled:r&&void 0!==t&&void 0!==s,...a,retry:(e,t)=>("object"!=typeof t||null===t||!("code"in t)||400!==t.code)&&e<3})};var TransferProjectPanel_TransferProjectButton=()=>{let{ui:e}=(0,w.oR)(),t=(0,w.Vm)(),s=null==t?void 0:t.ref,n=null==t?void 0:t.organization_id,{data:i}=(0,ep.tl)(),c=(0,w.P5)("disableProjectTransfer"),d=(i||[]).filter(e=>e.id!==n),[u,h]=(0,_.useState)(!1),[x,j]=(0,_.useState)(),{mutate:p,error:f,isLoading:g}=useProjectTransferMutation({onSuccess:()=>{e.setNotification({category:"success",duration:5e3,message:"Successfully transferred project ".concat(null==t?void 0:t.name,".")}),h(!1)}}),{data:v,error:b,isLoading:y,remove:N}=useProjectTransferPreviewQuery({projectRef:s,targetOrganizationSlug:x},{enabled:!g&&u});(0,_.useEffect)(()=>{u?j(void 0):N()},[u]);let P=(0,w.Xo)(a.KA.UPDATE,"organizations"),toggle=()=>{h(!u)};async function handleTransferProject(){void 0!==t&&void 0!==x&&p({projectRef:s,targetOrganizationSlug:x})}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.fC,{delayDuration:0,children:[(0,r.jsx)(C.xz,{asChild:!0,children:(0,r.jsx)(m.z,{onClick:toggle,type:"default",disabled:!P||c,children:"Transfer project"})}),(!P||c)&&(0,r.jsx)(C.h_,{children:(0,r.jsxs)(C.VY,{side:"bottom",children:[(0,r.jsx)(C.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:P?"Project transfers are temporarily disabled, please try again later.":"You need additional permissions to transfer this project"})})]})})]}),(0,r.jsx)(k.C,{closable:!0,onCancel:()=>toggle(),visible:u,loading:g,size:"xlarge",header:"Transfer project ".concat(null==t?void 0:t.name),customFooter:(0,r.jsxs)("div",{className:"flex items-center space-x-2 justify-end",children:[(0,r.jsx)(m.z,{type:"default",onClick:()=>h(!1),children:"Cancel"}),(0,r.jsx)(m.z,{onClick:()=>handleTransferProject(),disabled:!v||!v.valid||g||!x,children:"Transfer Project"})]}),children:(0,r.jsxs)("div",{className:"space-y-4 py-4 text-foreground-light",children:[(0,r.jsxs)(k.C.Content,{children:[(0,r.jsxs)("p",{className:"text-sm",children:["To transfer projects, the owner must be a member of both the source and target organizations. For further information see our"," ",(0,r.jsx)(o(),{href:"https://supabase.com/docs/guides/platform/project-transfer",className:"text-brand hover:underline",target:"_blank",rel:"noreferrer",children:"Documentation"}),"."]}),(0,r.jsx)("p",{className:"font-bold mt-6 text-sm",children:"Transferring considerations:"}),(0,r.jsxs)("ul",{className:"mt-4 space-y-5 text-sm px-4",children:[(0,r.jsxs)("li",{className:"flex gap-4",children:[(0,r.jsx)("span",{className:"shrink-0 mt-1",children:(0,r.jsx)(ed.Z,{})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold",children:"No downtime"}),(0,r.jsx)("p",{children:"There is no downtime or restrictions involved when transferring a project."})]})]}),(0,r.jsxs)("li",{className:"flex gap-4",children:[(0,r.jsx)("span",{className:"shrink-0 mt-1",children:(0,r.jsx)(eu.Z,{})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold",children:"Permissions"}),(0,r.jsx)("p",{children:"Depending on your role in the target organization, your level of permissions may change after transfer."})]})]}),(0,r.jsxs)("li",{className:"flex gap-4",children:[(0,r.jsx)("span",{className:"shrink-0 mt-1",children:(0,r.jsx)(em.Z,{w:14,className:"flex-shrink-0"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold",children:"Features"}),(0,r.jsx)("p",{children:"Moving your project to an organization with a smaller subscription plan may result in the loss of certain features (i.e. image transformations)."})]})]})]})]}),(0,r.jsx)(k.C.Content,{children:d&&(0,r.jsxs)("div",{className:"mt-8 mx-4 border-t pt-4 space-y-2",children:[0===d.length?(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-surface-200 p-3 text-sm",children:[(0,r.jsx)(l.Z,{})," You do not have any organizations with an organization-based subscription."]}):(0,r.jsxs)(eh.Z,{label:"Select Target Organization",layout:"vertical",value:x,onChange:e=>j(e),placeholder:"Select Organization",children:[(0,r.jsx)(eh.Z.Option,{disabled:!0,label:"Select Organization",value:"",children:"Select Organization"},"no-results"),d.map(e=>(0,r.jsx)(eh.Z.Option,{label:e.name,value:e.slug,addOnBefore:()=>(0,r.jsx)(ex.Z,{}),children:e.name},e.id))]}),(0,r.jsxs)("p",{className:"text-foreground-light text-sm",children:["The target organization needs to use"," ",(0,r.jsx)(o(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",className:"underline",children:"organization-based billing"}),". To migrate an organization to the new billing, head to your"," ",(0,r.jsx)(o(),{href:"/org/_/billing",target:"_blank",rel:"noreferrer",className:"underline",children:"organizations billing settings"}),"."]})]})}),(0,r.jsx)(ej.Z,{active:void 0!==x&&y,children:(0,r.jsx)(k.C.Content,{children:(0,r.jsxs)("div",{className:"px-4",children:[v&&v.valid&&(0,r.jsxs)("div",{className:"text-sm text-foreground-light p-4 bg-surface-200",children:[v.source_subscription_plan!==v.target_subscription_plan?(0,r.jsx)("div",{children:(0,r.jsxs)("p",{children:["Your project is currently on the"," ",v.source_subscription_plan," plan, whereas the target organization uses the ",v.target_subscription_plan," plan."]})}):(0,r.jsxs)("div",{children:["Your project and the target organization are both on the"," ",v.source_subscription_plan," subscription plan."]}),(0,r.jsxs)("div",{className:"my-4",children:[0===v.credits_on_source_organization?(0,r.jsxs)("span",{children:[" ","Your current organization won't be granted any prorated credits."]}):(0,r.jsxs)("span",{children:[" ","Your current organization will be granted"," ",(0,r.jsxs)("span",{className:"text-brand",children:["$",v.credits_on_source_organization]})," ","in credits as proration."]}),0===v.costs_on_target_organization?(0,r.jsxs)("span",{children:[" ","The target organization won't be charged any immediate upfront payment."]}):(0,r.jsxs)("span",{children:[" ","The target organization will be billed"," ",(0,r.jsxs)("span",{className:"text-brand",children:["$",v.costs_on_target_organization]})," ","immediately to prorate for the remainder of the billing period."]})]})]}),v&&v.warnings.length>0&&(0,r.jsx)(q.b,{withIcon:!0,variant:"warning",title:"Warnings for project transfer",className:"mt-3",children:(0,r.jsx)("div",{className:"space-y-1",children:v.warnings.map(e=>(0,r.jsx)("p",{children:e.message},e.key))})}),v&&v.errors.length>0&&(0,r.jsxs)(q.b,{withIcon:!0,variant:"danger",title:"Project cannot be transferred",children:[(0,r.jsx)("div",{className:"space-y-1",children:v.errors.map(e=>(0,r.jsx)("p",{children:e.message},e.key))}),v.members_exceeding_free_project_limit.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"These members have reached their maximum limits for the number of active Free plan projects within organizations where they are an administrator or owner:"}),(0,r.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(v.members_exceeding_free_project_limit||[]).map((e,t)=>(0,r.jsxs)("li",{children:[e.name," (Limit: ",e.limit," free projects)"]},"member-".concat(t)))}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of their projects before you can downgrade this project."})]})]}),b&&!f&&(0,r.jsx)(q.b,{withIcon:!0,variant:"danger",title:"Project cannot be transferred",children:(0,r.jsx)("p",{children:b.message})}),f&&(0,r.jsx)(q.b,{withIcon:!0,variant:"danger",title:"Project cannot be transferred",children:(0,r.jsx)("p",{children:f.message})})]})})})]})})]})},eg=s(26623),IconTruck_IconTruck=function(e){return(0,r.jsx)(S.Z,{icon:eg.Z,...e})},TransferProjectPanel_TransferProjectPanel=()=>{let e=(0,w.Vm)();return void 0===e?(0,r.jsx)(r.Fragment,{}):(0,r.jsxs)("section",{id:"transfer-project",children:[(0,r.jsx)(x.ph,{title:"Transfer Project",description:"Transfer your project to a different organization with no downtime."}),(0,r.jsx)(j.Z,{children:(0,r.jsx)(j.Z.Content,{children:(0,r.jsxs)("div",{className:"flex justify-between items-center gap-8",children:[(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)(IconTruck_IconTruck,{className:"mt-1"}),(0,r.jsxs)("div",{className:"space-y-1 xl:max-w-lg",children:[(0,r.jsx)("p",{className:"text-sm",children:"Transfer project to another organization"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"To transfer projects, the owner must be a member of both the source and target organizations."})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(TransferProjectPanel_TransferProjectButton,{})})]})})})]})},ev=s(51373);let ProjectSettings=()=>{let{project:e}=(0,h.d2)(),t=!!(null==e?void 0:e.parent_project_ref),{projectsTransfer:s}=(0,w.N3)(["projects:transfer"]);return(0,r.jsxs)("div",{className:"1xl:px-28 mx-auto flex flex-col gap-10 px-5 py-6 lg:px-16 xl:px-24 2xl:px-32 ",children:[(0,r.jsx)(General_General,{}),t?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(CustomDomainConfig_CustomDomainConfig,{}),s&&(0,r.jsx)(TransferProjectPanel_TransferProjectPanel,{}),(0,r.jsx)(DeleteProjectPanel_DeleteProjectPanel,{})]})]})};ProjectSettings.getLayout=e=>(0,r.jsx)(ev.dU,{title:"General",children:e});var eb=ProjectSettings},283:function(e,t,s){"use strict";var r=s(52322);s(2784);var a=s(8467),n=s(97265);t.Z=function(e){return(0,r.jsx)(n.Z,{icon:a.Z,...e})}},47048:function(e,t,s){"use strict";var r=s(52322);s(2784);var a=s(14948),n=s(97265);t.Z=function(e){return(0,r.jsx)(n.Z,{icon:a.Z,...e})}}},function(e){e.O(0,[1715,1187,6653,3844,8421,9362,4796,806,2591,5413,2531,1915,4079,4964,8211,452,8108,2250,9774,2888,179],function(){return e(e.s=31458)}),_N_E=e.O()}]);