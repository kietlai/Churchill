(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7893,2894],{85701:function(e,s,t){var l=t(39872),r=t(38101);e.exports=function(e,s,t){return e&&e.length?l(e,0,(s=t||void 0===s?1:r(s))<0?0:s):[]}},86350:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/realtime/inspector",function(){return t(46207)}])},80854:function(e,s,t){"use strict";function getDisplayName(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",{displayName:l,display_name:r,fullName:a,full_name:n,familyName:o,family_name:i,givenName:c,given_name:d,surname:x,lastName:h,last_name:m,firstName:u,first_name:p}=null!==(s=e.raw_user_meta_data)&&void 0!==s?s:{},g=o||i||x||h||m,f=c||d||u||p;return l||r||a||n||f&&g&&"".concat(f," ").concat(g)||t}function getAvatarUrl(e){var s;let{avatarUrl:t,avatarURL:l,avatar_url:r,profileUrl:a,profileURL:n,profile_url:o,profileImage:i,profile_image:c,profileImageUrl:d,profileImageURL:x,profile_image_url:h}=null!==(s=e.raw_user_meta_data)&&void 0!==s?s:{};return t||l||r||i||c||a||n||o||d||x||h}t.d(s,{E:function(){return getAvatarUrl},G:function(){return getDisplayName}})},2894:function(e,s,t){"use strict";t.d(s,{Q:function(){return RoleImpersonationSelector_RoleImpersonationPopover},G:function(){return RoleImpersonationSelector_RoleImpersonationSelector}});var l=t(52322),r=t(2784),a=t(56469),n=t(94580),o=t(4220),i=t(81395),c=t(30474),d=t(11033),x=t(80854),h=t(97036),m=t(38617);let ServiceRoleIcon=e=>{let{isSelected:s=!1}=e,{resolvedTheme:t}=(0,m.F)();return(0,l.jsx)("svg",{width:"53",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsxs)("g",{opacity:s?"1":".5",children:[(0,l.jsx)("rect",{x:"37.161",y:".53",width:"15",height:"15",rx:"5.5",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("path",{d:"M1 10.53h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,l.jsx)("rect",{x:"15.964",y:".53",width:"9",height:"15",rx:"4.5",stroke:"light"===t?"#7E868C":"#7E7E7E"}),(0,l.jsx)("path",{d:"M1 5.53h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"})]})})},AnonIcon=e=>{let{isSelected:s=!1}=e,{resolvedTheme:t}=(0,m.F)();return(0,l.jsx)("svg",{width:"53",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsxs)("g",{opacity:s?"1":".5",children:[(0,l.jsx)("path",{d:"M1 4.994a.5.5 0 0 0 0 1v-1Zm16.218 1h.5v-1h-.5v1ZM1 5.994h1.014v-1H1v1Zm3.04 0h2.028v-1H4.041v1Zm4.056 0h2.027v-1H8.096v1Zm4.054 0h2.027v-1H12.15v1Zm4.055 0h1.013v-1h-1.013v1Z",fill:"light"===t?"#7E868C":"#7E7E7E"}),(0,l.jsx)("path",{d:"m15.92 12.56 9.04-9.04",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("rect",{x:"15.964",y:".494",width:"9",height:"15",rx:"4.5",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("rect",{x:"37.161",y:".744",width:"15",height:"15",rx:"5.5",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("path",{d:"M1 10.494h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,l.jsx)("path",{d:"M15.96 7.562 22.568.956M19.049 14.885l5.957-5.958",stroke:"light"===t?"#11181C":"#EDEDED"})]})})},AuthenticatedIcon=e=>{let{isSelected:s=!1}=e,{resolvedTheme:t}=(0,m.F)();return(0,l.jsx)("svg",{width:"68",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsxs)("g",{opacity:s?"1":".5",children:[(0,l.jsx)("path",{d:"M15.63 5.156a.5.5 0 1 0 0 1v-1Zm16.218 1h.5v-1h-.5v1Zm-16.218 0h1.013v-1H15.63v1Zm3.04 0h2.028v-1h-2.027v1Zm4.055 0h2.028v-1h-2.028v1Zm4.055 0h2.027v-1H26.78v1Zm4.055 0h1.013v-1h-1.013v1Z",fill:"light"===t?"#7E868C":"#7E7E7E"}),(0,l.jsx)("path",{d:"m30.55 12.722 9.04-9.04",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("rect",{x:"30.594",y:".656",width:"9",height:"15",rx:"4.5",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("rect",{x:"51.791",y:".906",width:"15",height:"15",rx:"5.5",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("path",{d:"M15.63 10.656h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,l.jsx)("path",{d:"m30.59 7.724 6.607-6.606M33.679 15.047l5.957-5.958",stroke:"light"===t?"#11181C":"#EDEDED"}),(0,l.jsx)("path",{d:"M12.666 14.281v-1.333A2.667 2.667 0 0 0 10 10.28H6a2.667 2.667 0 0 0-2.667 2.667v1.333M8 7.615A2.667 2.667 0 1 0 8 2.28a2.667 2.667 0 0 0 0 5.334Z",stroke:"light"===t?"#11181C":"#EDEDED",strokeLinecap:"round",strokeLinejoin:"round"})]})})};var u=t(55216),p=t(60537),g=t(97265),IconMinus_IconMinus=function(e){return(0,l.jsx)(g.Z,{icon:p.Z,...e})},RoleImpersonationSelector_RoleImpersonationRadio=function(e){let{label:s,value:t,isSelected:r,onSelectedChange:a,icon:n}=e;return(0,l.jsxs)("label",{className:(0,o.cn)("border border-default rounded-md bg-surface-200 hover:bg-overlay-hover hover:border-control px-4 py-3 w-44 cursor-pointer transition-colors",r&&"border-stronger bg-surface-300"),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&a(t)},htmlFor:"role-".concat(t),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[n&&(0,l.jsx)("div",{children:n}),r&&(0,l.jsxs)("div",{className:"flex items-center justify-center p-0.5 bg-foreground text-background rounded-full",children:["boolean"==typeof r&&(0,l.jsx)(u.Z,{size:12,strokeWidth:"4",className:"text-background"}),"partially"===r&&(0,l.jsx)(IconMinus_IconMinus,{size:12,strokeWidth:"4",className:"text-background"})]})]}),(0,l.jsx)("input",{id:"role-".concat(t),type:"radio",name:"role",value:t,checked:!!r,onChange:e=>{a(e.target.value)},className:"invisible h-0 w-0 border-0"}),(0,l.jsxs)("span",{className:(0,o.cn)("text-sm text-foreground-light whitespace-nowrap select-none transition-colors",r&&"text-foreground"),children:[null!=s?s:t," role"]})]})},f=t(53111),j=t(2755),v=t(7503),b=t(48193),y=t(47716),N=t(38880),w=t(88724),C=t(31915),RoleImpersonationSelector_UserImpersonationSelector=()=>{var e,s,t,a;let[o,i]=(0,r.useState)(""),c=(0,f.Nr)(o,300),{project:h}=(0,j.d2)(),{data:m,isSuccess:u,isLoading:p,isError:g,error:S,isFetching:k,isPreviousData:R}=(0,b.xY)({projectRef:null==h?void 0:h.ref,keywords:c||void 0},{keepPreviousData:!0}),I=(0,d.fN)(),E=(null===(e=I.role)||void 0===e?void 0:e.type)==="postgrest"&&"authenticated"===I.role.role&&I.role.user;function impersonateUser(e){I.setRole({type:"postgrest",role:"authenticated",user:e})}return(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("h2",{className:"text-foreground text-base",children:E?"Impersonating ".concat((0,x.G)(E,null!==(a=null!==(t=null!==(s=E.email)&&void 0!==s?s:E.phone)&&void 0!==t?t:E.id)&&void 0!==a?a:"Unknown")):"Impersonate a User"}),(0,l.jsx)("p",{className:"text-sm text-foreground-light max-w-md",children:E?"Results will respect your database's Row-Level Security policies for this user.":"Select a user to respect your database's Row-Level Security policies for that particular user."}),E?(0,l.jsx)(UserImpersonatingRow,{user:E,onClick:function(){I.setRole(void 0)},isImpersonating:!0}):(0,l.jsxs)("div",{className:"flex flex-col gap-2 mt-4",children:[(0,l.jsx)(C.Z,{className:"table-editor-search border-none",icon:R&&k?(0,l.jsx)(y.Z,{className:"animate-spin text-foreground-lighter",size:16,strokeWidth:1.5}):(0,l.jsx)(N.Z,{className:"text-foreground-lighter",size:16,strokeWidth:1.5}),placeholder:"Search for a user..",onChange:e=>i(e.target.value.trim()),value:o,size:"small",actions:o&&(0,l.jsx)(n.z,{size:"tiny",type:"text",className:"px-1",onClick:()=>i(""),children:(0,l.jsx)(w.Z,{size:12,strokeWidth:2})})}),p&&(0,l.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center h-24",children:[(0,l.jsx)(y.Z,{className:"animate-spin",size:24}),(0,l.jsx)("span",{children:"Loading users..."})]}),g&&(0,l.jsx)(v.Z,{error:S,subject:"Failed to retrieve users"}),u&&(m.users.length>0?(0,l.jsx)("ul",{className:"divide-y max-h-[192px] overflow-y-scroll",role:"list",children:m.users.map(e=>(0,l.jsx)("li",{role:"listitem",children:(0,l.jsx)(UserRow,{user:e,onClick:impersonateUser})},e.id))}):(0,l.jsx)("div",{className:"flex flex-col gap-2 items-center justify-center h-24",children:(0,l.jsx)("p",{className:"text-foreground-light text-xs",role:"status",children:"No users found"})}))]})]})};let UserImpersonatingRow=e=>{var s,t,r;let{user:a,onClick:o,isImpersonating:i=!1}=e,d=(0,x.E)(a),h=(0,x.G)(a,null!==(r=null!==(t=null!==(s=a.email)&&void 0!==s?s:a.phone)&&void 0!==t?t:a.id)&&void 0!==r?r:"Unknown");return(0,l.jsxs)("div",{className:"flex items-center gap-3 py-2 text-foreground",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 bg-surface-200 pr-5 pl-0.5 py-0.5 border rounded-full max-w-l",children:[d?(0,l.jsx)("img",{className:"rounded-full w-5 h-5",src:d,alt:h}):(0,l.jsx)("div",{className:"rounded-full w-[21px] h-[21px] bg-surface-300 border border-strong flex items-center justify-center",children:(0,l.jsx)(c.Z,{size:12,strokeWidth:2})}),(0,l.jsx)("span",{className:"text-sm truncate",children:h})]}),(0,l.jsx)(n.z,{type:"secondary",onClick:()=>{o(a)},children:i?"Stop Impersonating":"Impersonate"})]})},UserRow=e=>{var s,t,r;let{user:a,onClick:o,isImpersonating:i=!1}=e,d=(0,x.E)(a),h=(0,x.G)(a,null!==(r=null!==(t=null!==(s=a.email)&&void 0!==s?s:a.phone)&&void 0!==t?t:a.id)&&void 0!==r?r:"Unknown");return(0,l.jsxs)("div",{className:"flex items-center justify-between py-2 text-foreground",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[d?(0,l.jsx)("img",{className:"rounded-full w-5 h-5",src:d,alt:h}):(0,l.jsx)("div",{className:"rounded-full w-[21px] h-[21px] bg-surface-300 border text-muted flex items-center justify-center text-background",children:(0,l.jsx)(c.Z,{size:12,strokeWidth:2})}),(0,l.jsx)("span",{className:"text-sm",children:h})]}),(0,l.jsx)(n.z,{type:"secondary",onClick:()=>{o(a)},children:i?"Stop Impersonating":"Impersonate"})]})};var RoleImpersonationSelector_RoleImpersonationSelector=e=>{var s;let{serviceRoleLabel:t,padded:a=!0}=e,n=(0,d.fN)(),[i,c]=(0,r.useState)(()=>{var e;return(null===(e=n.role)||void 0===e?void 0:e.type)==="postgrest"&&("anon"===n.role.role||"authenticated"===n.role.role)?n.role.role:"service_role"}),x=!!("authenticated"===i&&(null===(s=n.role)||void 0===s?void 0:s.type)==="postgrest"&&"authenticated"===n.role.role&&n.role.user);function onSelectedChange(e){"service_role"===e&&n.setRole(void 0),"anon"===e&&n.setRole({type:"postgrest",role:e}),c(e)}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:(0,o.cn)("flex flex-col gap-3",a?"p-5":"pb-5"),children:[(0,l.jsx)("h2",{className:"text-foreground text-base",children:"Database role settings"}),(0,l.jsx)("form",{onSubmit:e=>{e.preventDefault()},children:(0,l.jsxs)("fieldset",{className:"flex gap-3",children:[(0,l.jsx)(RoleImpersonationSelector_RoleImpersonationRadio,{value:"service_role",isSelected:"service_role"===i,onSelectedChange:onSelectedChange,label:t,icon:(0,l.jsx)(ServiceRoleIcon,{isSelected:"service_role"===i})}),(0,l.jsx)(RoleImpersonationSelector_RoleImpersonationRadio,{value:"anon",isSelected:"anon"===i,onSelectedChange:onSelectedChange,icon:(0,l.jsx)(AnonIcon,{isSelected:"anon"===i})}),(0,l.jsx)(RoleImpersonationSelector_RoleImpersonationRadio,{value:"authenticated",isSelected:"authenticated"===i&&(x||"partially"),onSelectedChange:onSelectedChange,icon:(0,l.jsx)(AuthenticatedIcon,{isSelected:"authenticated"===i})})]})}),"service_role"===i&&(0,l.jsxs)("p",{className:"text-foreground-light text-sm",children:["The default Postgres/superuser role. This has admin privileges.",(0,l.jsx)("br",{}),"It will bypass Row Level Security (RLS) policies."]}),"anon"===i&&(0,l.jsxs)("p",{className:"text-foreground-light text-sm",children:['For "anonymous access". This is the role which the API (PostgREST) will use when a user',(0,l.jsx)("br",{}),"is not logged in. It will respect Row Level Security (RLS) policies."]}),"authenticated"===i&&(0,l.jsxs)("p",{className:"text-foreground-light text-sm",children:['For "authenticated access". This is the role which the API (PostgREST) will use when',(0,l.jsx)("br",{})," a user is logged in. It will respect Row Level Security (RLS) policies."]})]}),"authenticated"===i&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.VD,{}),(0,l.jsx)("div",{className:(0,o.cn)("py-5",a&&"px-5"),children:(0,l.jsx)(RoleImpersonationSelector_UserImpersonationSelector,{})})]})]})},RoleImpersonationSelector_RoleImpersonationPopover=e=>{var s,t,c,x;let{serviceRoleLabel:h,variant:m="regular",align:u="end"}=e,p=(0,d.fN)(),[g,f]=(0,r.useState)(!1),j=null!==(x=null!==(c=null===(s=p.role)||void 0===s?void 0:s.role)&&void 0!==c?c:h)&&void 0!==x?x:"service role";return(0,l.jsxs)(a.J2,{open:g,onOpenChange:f,modal:!1,children:[(0,l.jsx)(a.xo,{asChild:!0,children:(0,l.jsx)(n.z,{size:"tiny",type:"default",className:(0,o.cn)("h-[26px] pr-3 gap-0","connected-on-right"===m&&"rounded-r-none border-r-0","connected-on-left"===m&&"rounded-l-none border-l-0","connected-on-both"===m&&"rounded-none border-x-0"),children:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"text-foreground-muted",children:"role"}),(0,l.jsx)("span",{children:j}),(null===(t=p.role)||void 0===t?void 0:t.type)==="postgrest"&&"authenticated"===p.role.role&&(0,l.jsx)(UserRoleButtonSection,{user:p.role.user}),(0,l.jsx)(i.Z,{className:"text-muted",strokeWidth:1,size:12})]})})}),(0,l.jsx)(a.yk,{className:"p-0 w-full overflow-hidden bg-overlay",side:"bottom",align:u,children:(0,l.jsx)(RoleImpersonationSelector_RoleImpersonationSelector,{serviceRoleLabel:h})})]})};let UserRoleButtonSection=e=>{var s,t,r;let{user:a}=e,n=(0,x.E)(a),o=(0,x.G)(a,null!==(r=null!==(t=null!==(s=a.email)&&void 0!==s?s:a.phone)&&void 0!==t?t:a.id)&&void 0!==r?r:"Unknown");return(0,l.jsxs)("div",{className:"flex gap-1 items-center pl-0.5 pr-1.5 h-[21px] bg-surface-200 rounded-full overflow-hidden",children:[n?(0,l.jsx)("img",{className:"rounded-full w-[18px] h-[18px]",src:n,alt:o}):(0,l.jsx)("div",{className:"rounded-full w-[18px] h-[18px] bg-surface-100 border flex items-center justify-center text-light",children:(0,l.jsx)(c.Z,{size:12,strokeWidth:2})}),(0,l.jsx)("span",{className:"truncate max-w-[84px]",children:o})]})}},19776:function(e,s,t){"use strict";var l=t(52322),r=t(94580),a=t(71813),n=t(49097),o=t(2784);s.Z=e=>{let{text:s,children:t,onClick:i,bounceIconOnCopy:c,...d}=e,[x,h]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(!x)return;let e=setTimeout(()=>h(!1),2e3);return()=>clearTimeout(e)},[x]),(0,l.jsx)(r.z,{onClick:e=>{h(!0),(0,a.vQ)(s),null==i||i(e)},icon:(0,l.jsx)(n.Z,{size:"tiny",className:[x&&c?"animate-bounce":"","transition"].join(" ")}),...d,children:null!=t?t:x?"Copied":"Copy"})}},48193:function(e,s,t){"use strict";t.d(s,{RT:function(){return n},xY:function(){return useUsersQuery}});var l=t(58943),r=t(9402),a=t(549);let n=10;async function getUsers(e,s){let{projectRef:t,page:l=1,keywords:a="",verified:o}=e;if(!t)throw Error("Project ref is required");let i={limit:n.toString(),offset:((l-1)*10).toString(),keywords:a};o&&(i.verified=o);let{data:c,error:d}=await (0,r.U2)("/platform/auth/{ref}/users",{params:{path:{ref:t},query:i},signal:s});if(d)throw d;return c}let useUsersQuery=function(e){let{projectRef:s,page:t,keywords:r,verified:n}=e,{enabled:o=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,l.a)(a.o.users(s,{page:t,keywords:r,verified:n}),e=>{let{signal:l}=e;return getUsers({projectRef:s,page:t,keywords:r,verified:n},l)},{enabled:o&&void 0!==s,...i})}},46535:function(e,s,t){"use strict";t.d(s,{s:function(){return useProjectPostgrestConfigQuery}});var l=t(58943),r=t(3218),a=t(46732),n=t(58970);async function getProjectPostgrestConfig(e,s){let{projectRef:t}=e;if(!t)throw Error("projectRef is required");let l=await (0,r.U2)("".concat(a.T5,"/projects/").concat(t,"/config/postgrest"),{signal:s});if(l.error)throw l.error;return l}let useProjectPostgrestConfigQuery=function(e){let{projectRef:s}=e,{enabled:t=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,l.a)(n.U.postgrest(s),e=>{let{signal:t}=e;return getProjectPostgrestConfig({projectRef:s},t)},{enabled:t&&void 0!==s,...r})}},46207:function(e,s,t){"use strict";t.r(s),t.d(s,{InspectorPage:function(){return InspectorPage},default:function(){return ej}});var l=t(52322),r=t(59491),a=t(2784),n=t(60674),o=t(24990),i=t(56626);let c=(0,i.Z)("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),d=(0,i.Z)("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);var x=t(94580),h=t(88883),m=t(39097),u=t.n(m),p=t(63955),g=t(56469),f=t(43502),j=t(69218),v=t(84283),b=t(30195);let ChooseChannelPopover=e=>{let{config:s,onChangeConfig:t}=e,[r,n]=(0,a.useState)(!1),o=b.Ry({channel:b.Z_()}),i=(0,p.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,h.F)(o),defaultValues:{channel:""}}),onSubmit=()=>{n(!1),t({...s,channelName:i.getValues("channel"),enabled:!0})};return(0,l.jsxs)(g.J2,{open:r,onOpenChange:e=>{!0===e&&i.setValue("channel",s.channelName),n(e)},children:[(0,l.jsx)(g.xo,{asChild:!0,children:(0,l.jsx)(x.z,{className:"rounded-r-none",type:"default",size:"tiny",iconRight:(0,l.jsx)(f.Z,{}),children:(0,l.jsx)("p",{className:"max-w-[120px] truncate",title:s.channelName.length>0?s.channelName:"",children:s.channelName.length>0?"Channel: ".concat(s.channelName):"Join a channel"})})}),(0,l.jsx)(g.yk,{className:"p-0 w-[320px]",align:"start",children:(0,l.jsx)("div",{className:"p-4 flex flex-col text-sm",children:0===s.channelName.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.l0,{...i,children:(0,l.jsx)("form",{id:"realtime-channel",onSubmit:i.handleSubmit(()=>onSubmit()),children:(0,l.jsx)(j.Wi,{name:"channel",control:i.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(j.xJ,{children:[(0,l.jsx)("label",{className:"text-foreground text-xs mb-2",children:"Name of channel"}),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(j.NI,{children:(0,l.jsx)(v.I,{...s,autoComplete:"off",className:"rounded-r-none text-xs px-2.5 py-1 h-auto",placeholder:"Enter a channel name"})}),(0,l.jsx)(x.z,{type:"primary",className:"rounded-l-none",disabled:0===i.getValues().channel.length,onClick:()=>onSubmit(),children:"Listen to channel"})]})]})}})})}),(0,l.jsxs)("p",{className:"text-xs text-foreground-lighter mt-2",children:["The channel you initialize with the Supabase Realtime client. Learn more in"," ",(0,l.jsx)(u(),{href:"https://supabase.com/docs/guides/realtime/concepts#channels",target:"_blank",rel:"noreferrer",className:"underline hover:text-foreground transition",children:"our docs"})]})]}):(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,l.jsx)("p",{className:"text-foreground text-xs",children:"Currently joined channel:"}),(0,l.jsx)("p",{className:"text-xs border border-scale-600  py-0.5 px-1 rounded-md bg-surface-200",children:s.channelName})]}),(0,l.jsx)("p",{className:"text-xs text-foreground-lighter mt-2",children:"If you leave this channel, all of the messages populated on this page will disappear"}),(0,l.jsx)(x.z,{type:"default",onClick:()=>t({...s,channelName:"",enabled:!1}),children:"Leave channel"})]})})})]})},y=(0,i.Z)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"16",key:"10p56q"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var N=t(4220),w=t(84959),C=t(97265);let SvgComponent=()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{stroke:"currentColor",strokeLinejoin:"round",strokeMiterlimit:10,d:"m23.149 23.499 3.424 7.83a.5.5 0 0 0 .942-.074l.74-2.868a.5.5 0 0 1 .364-.36l3.039-.756a.5.5 0 0 0 .08-.943l-7.93-3.487a.5.5 0 0 0-.66.658Z"}),(0,l.jsx)("path",{stroke:"currentColor",strokeLinejoin:"round",strokeMiterlimit:10,d:"M24.544 32.746h-5.623a3 3 0 0 1-3-3V18.5a3 3 0 0 1 3-3h11.247a3 3 0 0 1 3 3v5.623",opacity:.45})]});var IconPresence_IconPresence=function(e){return(0,l.jsx)(C.Z,{src:(0,l.jsx)(SvgComponent,{}),viewBox:"12.5 12 24 24",...e})},S=t(49730);let IconBroadcast_SvgComponent=()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{id:"Ellipse 146",d:"M17.3154 6.70312C18.6968 8.06227 19.5532 9.95249 19.5532 12.0426C19.5532 14.1326 18.6968 16.0229 17.3154 17.382M6.79102 6.70312C5.40966 8.06227 4.55322 9.95249 4.55322 12.0426C4.55322 14.1326 5.40966 16.0229 6.79102 17.382",stroke:"currentColor",strokeMiterlimit:"10",strokeLinejoin:"bevel",opacity:.45}),(0,l.jsx)("ellipse",{id:"Ellipse 144",cx:"12.0532",cy:"12.0428",rx:"3.00928",ry:"3.00666",stroke:"currentColor",strokeMiterlimit:"10",strokeLinejoin:"bevel"}),(0,l.jsx)("path",{id:"Vector 96",d:"M12.0747 15.0488L12.0747 23.9996",stroke:"currentColor",strokeMiterlimit:"10",strokeLinejoin:"bevel"})]});var IconBroadcast_IconBroadcast=function(e){return(0,l.jsx)(C.Z,{src:(0,l.jsx)(IconBroadcast_SvgComponent,{}),viewBox:"0 0 24 24",...e})};let IconDatabaseChanges_SvgComponent=()=>(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:25,height:24,fill:"none",children:[(0,l.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"bevel",strokeMiterlimit:10,d:"M20.307 12a7.807 7.807 0 0 1-7.807 7.808M4.693 12A7.807 7.807 0 0 1 12.5 4.193",opacity:.45}),(0,l.jsx)("circle",{cx:17.512,cy:6.971,r:3.723,stroke:"currentColor",strokeLinejoin:"bevel",strokeMiterlimit:10}),(0,l.jsx)("path",{stroke:"currentColor",strokeLinejoin:"bevel",strokeMiterlimit:10,d:"m10.11 13.287 2.137 3.703-2.138 3.703H5.833L3.695 16.99l2.138-3.703h4.276Z"})]});var IconDatabaseChanges_IconDatabaseChanges=function(e){return(0,l.jsx)(C.Z,{src:(0,l.jsx)(IconDatabaseChanges_SvgComponent,{}),viewBox:"0 0 25 24",...e})},k=t(31915),R=t(1681),I=t(98050);let ApplyConfigModal=e=>(0,l.jsx)(I.Z,{header:"Previously found messages will be lost",danger:!0,buttonLabel:"Confirm",size:"small",...e,children:(0,l.jsx)(R.C.Content,{children:(0,l.jsxs)("div",{className:"py-4",children:[(0,l.jsx)("p",{className:"text-sm text-foreground"}),(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"The realtime inspector will clear currently collected messages and start listening for new messages matching the updated filters."})]})})});var E=t(50932);let FilterSchema=e=>{let{value:s,onChange:t}=e;return(0,l.jsxs)("div",{className:"flex flex-row gap-4 items-center",children:[(0,l.jsx)("p",{className:"w-[60px] flex justify-end text-sm",children:"WHERE"}),(0,l.jsx)(E.Z,{disabled:!0,supportSelectAll:!0,size:"small",selectedSchemaName:s,onSelectSchema:t,className:"rounded-l-none [&>button>span>div]:py-0 w-64"})]})};var _=t(13781),D=t(50074),z=t(47742),Z=t(50671),M=t(50138),P=t(55216),L=t(2755),T=t(24435),RealtimeFilterPopover_TableSelector=e=>{let{className:s,size:t="tiny",showError:r=!0,selectedSchemaName:n,selectedTableName:o,onSelectTable:i}=e,[c,d]=(0,a.useState)(!1),{project:h}=(0,L.d2)(),{data:m,isLoading:u,isSuccess:p,isError:f,error:j,refetch:v}=(0,T.H)({projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString,schema:n}),b=((null==m?void 0:m.pages[0].data.entities)?[...null==m?void 0:m.pages[0].data.entities]:[]).sort((e,s)=>e.name>s.name?0:-1);return(0,l.jsxs)("div",{className:s,children:[u&&(0,l.jsx)(x.z,{type:"outline",size:t,className:"w-full [&>span]:w-full ".concat("small"===t?"py-1.5":""),icon:(0,l.jsx)(_.Z,{className:"animate-spin",size:12}),children:(0,l.jsx)("p",{className:"flex text-xs text-light",children:"Loading tables..."})}),r&&f&&(0,l.jsxs)(D.bZ,{variant:"warning",className:"!px-3 !py-3",children:[(0,l.jsx)(D.Cd,{className:"text-xs text-amber-900",children:"Failed to load tables"}),(0,l.jsxs)(D.X,{className:"text-xs mb-2",children:["Error: ",null==j?void 0:j.message]}),(0,l.jsx)(x.z,{type:"default",size:"tiny",onClick:()=>v(),children:"Reload tables"})]}),p&&(0,l.jsxs)(g.J2,{open:c,onOpenChange:d,modal:!1,children:[(0,l.jsx)(g.xo,{asChild:!0,children:(0,l.jsx)(x.z,{size:t,type:"outline",className:"w-full [&>span]:w-full ".concat("small"===t?"py-1.5":""),iconRight:(0,l.jsx)(z.Z,{className:"text-foreground-light rotate-90",strokeWidth:2,size:12}),children:(0,l.jsxs)("div",{className:"w-full flex space-x-3",children:[(0,l.jsx)("p",{className:"text-xs text-light",children:"table"}),(0,l.jsx)("p",{className:"text-xs",children:"*"===o?"All tables":o})]})})}),(0,l.jsx)(g.yk,{className:"p-0 w-64",side:"bottom",align:"start",children:(0,l.jsxs)(Z.mY,{children:[(0,l.jsx)(Z.sZ,{placeholder:"Find table..."}),(0,l.jsxs)(Z.e8,{children:[(0,l.jsx)(Z.rb,{children:"No tables found"}),(0,l.jsx)(Z.fu,{children:(0,l.jsxs)(M.x,{className:(b||[]).length>7?"h-[210px]":"",children:[(0,l.jsxs)(Z.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{i("*",void 0),d(!1)},onClick:()=>{i("*",void 0),d(!1)},children:[(0,l.jsx)("span",{children:"All tables"}),"*"===n&&(0,l.jsx)(P.Z,{className:"text-brand",strokeWidth:2})]},"all-tables"),null==b?void 0:b.map(e=>(0,l.jsxs)(Z.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{i(e.name,e.id),d(!1)},onClick:()=>{i(e.name,e.id),d(!1)},children:[(0,l.jsx)("span",{children:e.name}),n===e.name&&(0,l.jsx)(P.Z,{className:"text-brand",strokeWidth:2})]},e.id))]})})]})]})})]})]})};let TableSchema=e=>{let{value:s,schema:t,onChange:r}=e;return(0,l.jsxs)("div",{className:"flex flex-row gap-4 items-center",children:[(0,l.jsx)("p",{className:"w-[60px] flex justify-end text-sm",children:"AND"}),(0,l.jsx)(RealtimeFilterPopover_TableSelector,{selectedSchemaName:t,selectedTableName:s,onSelectTable:r,className:"w-64",size:"small"})]})},RealtimeFilterPopover=e=>{let{config:s,onChangeConfig:t}=e,[r,n]=(0,a.useState)(!1),[o,i]=(0,a.useState)(!1),[c,d]=(0,a.useState)(s),h="public"!==s.schema;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(g.J2,{open:r,onOpenChange:e=>{!0===e&&d(s),n(e)},children:[(0,l.jsx)(g.xo,{asChild:!0,children:(0,l.jsxs)(x.z,{icon:(0,l.jsx)(y,{size:"16"}),type:h?"primary":"dashed",className:(0,N.cn)("rounded-full px-1.5 text-xs",h?"!py-0.5":"!py-1"),size:"small",children:[h?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"mr-1",children:"Filtered by "}),(0,l.jsxs)(w.Z,{className:"!bg-brand-400 !text-brand-600",children:["schema: ","*"===s.schema?"All schemas":s.schema]})]}):(0,l.jsx)("span",{className:"mr-1",children:"Filter messages"}),"*"!==s.table?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:" and "}),(0,l.jsxs)(w.Z,{className:"!bg-brand-400 !text-brand-600",children:["table: ",s.table]})]}):null]})}),(0,l.jsxs)(g.yk,{className:"p-0 w-[365px]",align:"start",children:[(0,l.jsx)("div",{className:"border-b border-overlay text-xs px-4 py-3 text-foreground",children:"Listen to event types"}),(0,l.jsxs)("div",{className:"py-3 px-4 border-b border-overlay",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2.5 items-center",children:[(0,l.jsx)(IconPresence_IconPresence,{size:"xlarge",className:"bg-foreground rounded text-background-muted"}),(0,l.jsx)("label",{htmlFor:"toggle-presence",className:"text-sm",children:"Presence"})]}),(0,l.jsx)(S.Z,{id:"toggle-presence",size:"tiny",checked:c.enablePresence,onChange:()=>d({...c,enablePresence:!c.enablePresence})})]}),(0,l.jsx)("p",{className:"text-xs text-foreground-light pt-1",children:"Store and synchronize user state consistently across clients"})]}),(0,l.jsxs)("div",{className:"py-3 px-4 border-b border-overlay",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex gap-2.5 items-center",children:[(0,l.jsx)(IconBroadcast_IconBroadcast,{size:"xlarge",className:"bg-foreground rounded text-background-muted"}),(0,l.jsx)("label",{htmlFor:"toggle-broadcast",className:"text-sm",children:"Broadcast"})]}),(0,l.jsx)(S.Z,{id:"toggle-broadcast",size:"tiny",checked:c.enableBroadcast,onChange:()=>d({...c,enableBroadcast:!c.enableBroadcast})})]}),(0,l.jsx)("p",{className:"text-xs  text-foreground-light pt-1",children:"Send any data to any client subscribed to the same channel"})]}),(0,l.jsxs)("div",{className:"py-3 px-4 border-b border-overlay",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex gap-2.5 items-center",children:[(0,l.jsx)(IconDatabaseChanges_IconDatabaseChanges,{size:"xlarge",className:"bg-foreground rounded text-background-muted"}),(0,l.jsx)("label",{htmlFor:"toggle-db-changes",className:"text-sm",children:"Database changes"})]}),(0,l.jsx)(S.Z,{id:"toggle-db-changes",size:"tiny",checked:c.enableDbChanges,onChange:()=>d({...c,enableDbChanges:!c.enableDbChanges})})]}),(0,l.jsx)("p",{className:"text-xs text-foreground-light pt-1",children:"Listen for Database inserts, updates, deletes and more"})]}),c.enableDbChanges&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"border-b border-overlay text-xs px-4 py-3 text-foreground",children:"Filter messages from database changes"}),(0,l.jsxs)("div",{className:"flex border-b border-overlay p-4 gap-y-2 flex-col",children:[(0,l.jsx)(FilterSchema,{value:c.schema,onChange:e=>d({...c,schema:e,table:"*"})}),(0,l.jsx)(TableSchema,{value:c.table,schema:c.schema,onChange:e=>d({...c,table:e})})]}),(0,l.jsxs)("div",{className:"border-b border-overlay p-4 flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-4 items-center",children:[(0,l.jsx)("p",{className:"w-[60px] flex justify-end text-sm",children:"AND"}),(0,l.jsx)(k.Z,{size:"tiny",className:"flex-grow",placeholder:"body=eq.hey",value:c.filter,onChange:e=>d({...c,filter:e.target.value})})]}),(0,l.jsxs)("p",{className:"text-xs text-foreground-light pl-[80px]",children:["Learn more about realtime filtering in"," ",(0,l.jsx)(u(),{className:"underline",target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/realtime/postgres-changes#available-filters",children:"our docs"})]})]})]}),(0,l.jsxs)("div",{className:"px-4 py-2 gap-2 flex justify-end",children:[(0,l.jsx)(x.z,{type:"default",onClick:()=>n(!1),children:"Cancel"}),(0,l.jsx)(x.z,{onClick:()=>i(!0),children:"Apply"})]})]})]}),(0,l.jsx)(ApplyConfigModal,{visible:o,onSelectCancel:()=>i(!1),onSelectConfirm:()=>{t(c),i(!1),n(!1)}})]})};var A=t(2894),F=t(25544),B=t(46535),U=t(74915),O=t(11033);let RealtimeTokensPopover=e=>{let{config:s,onChangeConfig:t}=e,{data:r}=(0,F.q)({projectRef:s.projectRef}),n=null==r?void 0:r.autoApiService,o=(null==n?void 0:n.service_api_keys.find(e=>"service_role key"===e.name))?n.serviceApiKey:void 0,i=(null==n?void 0:n.service_api_keys.find(e=>"anon key"===e.name))?n.serviceApiKey:void 0,{data:c}=(0,B.s)({projectRef:s.projectRef}),d=null==c?void 0:c.jwt_secret,x=(0,O.fN)();return(0,a.useEffect)(()=>{let e;let l=null;void 0!==s.projectRef&&void 0!==d&&void 0!==x.role&&"postgrest"===x.role.type?(e=i,l=(0,U.Wn)(s.projectRef,d,x.role)):e=o,e&&t({...s,token:e,bearer:l})},[s.projectRef,d,o,x.role]),(0,l.jsx)(A.Q,{align:"start",variant:"connected-on-both"})},Header=e=>{let{config:s,onChangeConfig:t}=e;return(0,l.jsxs)("div",{className:"flex flex-row h-14 gap-2.5 items-center px-4",children:[(0,l.jsxs)("div",{className:"flex flex-row",children:[(0,l.jsx)(ChooseChannelPopover,{config:s,onChangeConfig:t}),(0,l.jsx)(RealtimeTokensPopover,{config:s,onChangeConfig:t}),(0,l.jsxs)(o.fC,{delayDuration:0,children:[(0,l.jsx)(o.xz,{asChild:!0,children:(0,l.jsx)(x.z,{size:"tiny",type:s.enabled?"warning":"primary",className:"rounded-l-none border-l-0",disabled:0===s.channelName.length,icon:s.enabled?(0,l.jsx)(c,{size:"16"}):(0,l.jsx)(d,{size:"16"}),onClick:()=>t({...s,enabled:!s.enabled}),children:s.enabled?"Stop listening":"Start listening"})}),0===s.channelName.length&&(0,l.jsx)(o.h_,{children:(0,l.jsxs)(o.VY,{side:"bottom",children:[(0,l.jsx)(o.Eh,{className:"radix-tooltip-arrow"}),(0,l.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,l.jsx)("span",{className:"text-xs text-foreground",children:"You'll need to join a channel first"})})]})})]})]}),(0,l.jsx)(RealtimeFilterPopover,{config:s,onChangeConfig:t})]})};var W=t(18149),H=t.n(W),J=t(47716),V=t(47370),G=t(63157),Q=t(50575),Y=t(88979),q=t(19776),K=t(28879),X=t.n(K);let unixMicroToIsoTimestamp=e=>X().unix(Number(e)/1e3).toISOString(),RowLayout=e=>{let{children:s}=e;return(0,l.jsx)("div",{className:"flex h-full w-full items-center gap-4",children:s})},SelectionDetailedTimestampRow=e=>{let{value:s,hideCopy:t=!1}=e;return(0,l.jsx)(SelectionDetailedRow,{label:"Timestamp",value:unixMicroToIsoTimestamp(s),hideCopy:t})},SelectionDetailedRow=e=>{let{label:s,value:t,valueRender:r,hideCopy:a=!1}=e;return(0,l.jsxs)("div",{className:"grid grid-cols-12 group",children:[(0,l.jsx)("span",{className:"text-scale-900 text-sm col-span-4 whitespace-pre-wrap",children:s}),(0,l.jsx)("span",{className:"text-scale-1200 text-sm col-span-6 whitespace-pre-wrap break-all",children:null!=r?r:t}),!a&&(0,l.jsx)(q.Z,{bounceIconOnCopy:!0,text:t,className:"group-hover:opacity-100 opacity-0 my-auto transition col-span-2  h-4 w-4 px-0 py-0",type:"text",title:"Copy to clipboard"})]})},LogsDivider=()=>(0,l.jsx)("div",{className:"h-px w-full bg-panel-border-interior-light [[data-theme*=dark]_&]:bg-panel-border-interior-dark"}),SelectedRealtimeMessagePanel=e=>{let{log:s}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"px-8",children:[(0,l.jsx)("span",{className:"col-span-4 text-sm text-scale-900",children:"Message"}),(0,l.jsx)("p",{className:"text-wrap mt-2 overflow-x-auto whitespace-pre-wrap font-mono text-xs text-scale-1200",children:s.message})]}),(0,l.jsx)(LogsDivider,{}),(0,l.jsx)("div",{className:"px-8 space-y-2",children:(0,l.jsx)(SelectionDetailedTimestampRow,{hideCopy:!0,value:s.timestamp})}),(0,l.jsx)(LogsDivider,{}),(0,l.jsxs)("div",{className:"px-8",children:[(0,l.jsx)("h3",{className:"mb-4 text-sm text-foreground-lighter",children:"Metadata"}),(0,l.jsx)("pre",{className:"syntax-highlight overflow-x-auto text-sm",children:(0,l.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:s.metadata?function(e){let s=JSON.stringify(e,null,2);s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let t=s.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var s="number text-tomato-900";return/^"/.test(e)?s=/:$/.test(e)?"key text-scale-1200":"string text-brand-600":/true|false/.test(e)?s="boolean text-blue-900":/null/.test(e)&&(s="null text-amber-1100"),'<span class="'+s+'">'+e+"</span>"}),l=t.split("\n").map(e=>'<span class="line text-xs">'.concat(e,"</span>"));return l.join("\n")}(s.metadata):""}})})]})]})};var Inspector_MessageSelection=e=>{let{log:s,onClose:t}=e,r=(0,a.useMemo)(()=>JSON.stringify(s,null,2),[s]);return(0,l.jsxs)("div",{className:(0,N.cn)("relative flex h-full flex-grow flex-col border-l border-t-2 overflow-y-scroll bg-gray-200"),children:[(0,l.jsx)("div",{className:(0,N.cn)("absolute flex h-full w-full flex-col items-center justify-center gap-2 bg-scale-200 text-center opacity-0 transition-all",s?"z-0 opacity-0":"z-10 opacity-100"),children:(0,l.jsxs)("div",{className:(0,N.cn)("flex w-full max-w-sm scale-95 flex-col items-center justify-center gap-6 text-center opacity-0 transition-all delay-300 duration-500",s?"mt-0 scale-95 opacity-0":"mt-8 scale-100 opacity-100"),children:[(0,l.jsxs)("div",{className:"relative flex h-4 w-32 items-center rounded border border-default px-2",children:[(0,l.jsx)("div",{className:"h-0.5 w-2/3 rounded-full bg-overlay-hover"}),(0,l.jsx)("div",{className:"absolute right-1 -bottom-4",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})})})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("h3",{className:"text-sm text-foreground",children:"Select an message"}),(0,l.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Click on a message on the left to view details."})]})]})}),(0,l.jsxs)("div",{className:"relative h-px flex-grow",children:[(0,l.jsxs)("div",{className:"pt-4 flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"px-4 flex flex-row justify-between items-center",children:[(0,l.jsx)("div",{className:"transition",children:(0,l.jsx)(q.Z,{text:r,type:"default",title:"Copy log to clipboard"})}),(0,l.jsx)(x.z,{type:"text",className:"cursor-pointer transition hover:text-scale-1200 h-8 w-8 px-0 py-0 flex items-center justify-center",onClick:t,children:(0,l.jsx)(Y.Z,{size:14,strokeWidth:2,className:"text-scale-900"})})]}),(0,l.jsx)("div",{className:"h-px w-full bg-scale-600 rounded"})]}),(0,l.jsx)("div",{className:"flex flex-col space-y-6 py-4",children:s&&(0,l.jsx)(SelectedRealtimeMessagePanel,{log:s})})]})]})},Inspector_NoChannelEmptyState=()=>(0,l.jsxs)("div",{className:"border bg-background border-border rounded-md justify-start items-center flex flex-col w-10/12 relative",children:[(0,l.jsx)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b rounded-t-md",children:(0,l.jsxs)("div",{className:"grow flex-col flex gap-y-1",children:[(0,l.jsx)("p",{className:"text-foreground",children:"Join a channel to start listening to messages"}),(0,l.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Channels are the building blocks of realtime where clients can bi-directionally send and receive messages in."})]})}),(0,l.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex rounded-b-md",children:[(0,l.jsxs)("div",{className:"grow flex-col flex",children:[(0,l.jsx)("p",{className:"text-foreground",children:"Not sure what to do?"}),(0,l.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Browse our documentation"})]}),(0,l.jsx)(x.z,{type:"default",iconRight:(0,l.jsx)(G.Z,{}),children:(0,l.jsx)("a",{href:"https://supabase.com/docs/guides/realtime",target:"_blank",rel:"noreferrer",children:"Documentation"})})]})]}),$=t(16236);let ee={PRESENCE:(0,l.jsx)(IconPresence_IconPresence,{size:"xlarge"}),BROADCAST:(0,l.jsx)(IconBroadcast_IconBroadcast,{size:"xlarge"}),POSTGRES:(0,l.jsx)(IconDatabaseChanges_IconDatabaseChanges,{size:"xlarge"}),SYSTEM:(0,l.jsx)($.Z,{size:"large"})},es=[{name:"timestamp-with-truncated-text",key:"main-column",renderCell:e=>{let s=e.row.message;return(0,l.jsxs)(RowLayout,{children:[(0,l.jsx)("div",{className:(0,N.cn)("flex justify-center items-center min-w-[24px]",isErrorLog(e.row)?"text-warning-600":"text-green-900"),children:ee[s]}),(0,l.jsx)("span",{className:(0,N.cn)("font-mono",isErrorLog(e.row)?"!text-warning-600":""),children:new Date(e.row.timestamp).toISOString()}),(0,l.jsx)("span",{className:(0,N.cn)("truncate font-mono",isErrorLog(e.row)?"!text-warning-600":""),children:JSON.stringify(e.row.metadata)})]})}}],isErrorLog=e=>{var s;return"SYSTEM"===e.message&&(null===(s=e.metadata)||void 0===s?void 0:s.status)==="error"},NoResultAlert=e=>{let{enabled:s,hasChannelSet:t,showSendMessage:r}=e,{ref:a}=(0,n.UO)();return(0,l.jsx)("div",{className:"w-full max-w-md flex items-center flex-col",children:t?(0,l.jsxs)(l.Fragment,{children:[s?(0,l.jsx)("p",{children:"No Realtime messages found"}):null,(0,l.jsx)("p",{className:"text-foreground-lighter",children:"Realtime message logs will be shown here"}),(0,l.jsxs)("div",{className:"mt-4 border bg-surface-100 border-border rounded-md justify-start items-center flex flex-col w-full",children:[(0,l.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b",children:[(0,l.jsx)(IconBroadcast_IconBroadcast,{size:"xlarge",className:"text-background bg-foreground rounded w-6"}),(0,l.jsxs)("div",{className:"grow flex-col flex",children:[(0,l.jsx)("p",{className:"text-foreground",children:"Create a Broadcast message"}),(0,l.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Send a message in the channel"})]}),(0,l.jsx)(x.z,{type:"default",onClick:r,children:"Broadcast a message"})]}),(0,l.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b",children:[(0,l.jsx)(IconPresence_IconPresence,{size:"xlarge",className:"text-background bg-foreground rounded w-6"}),(0,l.jsxs)("div",{className:"grow flex-col flex",children:[(0,l.jsx)("p",{className:"text-foreground",children:"Join from another browser tab"}),(0,l.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Send messages between multiple clients"})]}),(0,l.jsx)(u(),{href:"/project/".concat(a,"/realtime/inspector"),target:"_blank",rel:"noreferrer",children:(0,l.jsx)(x.z,{type:"default",iconRight:(0,l.jsx)(G.Z,{}),children:"Open inspector"})})]}),(0,l.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b",children:[(0,l.jsx)(IconDatabaseChanges_IconDatabaseChanges,{size:"xlarge",className:"text-background bg-foreground rounded w-6"}),(0,l.jsxs)("div",{className:"grow flex-col flex",children:[(0,l.jsx)("p",{className:"text-foreground",children:"Listen to a table for changes"}),(0,l.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Tables must have realtime enabled"})]}),(0,l.jsx)(u(),{href:"/project/".concat(a,"/database/replication"),target:"_blank",rel:"noreferrer",children:(0,l.jsx)(x.z,{type:"default",iconRight:(0,l.jsx)(G.Z,{}),children:"Replication settings"})})]}),(0,l.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex rounded-b-md bg-background",children:[(0,l.jsxs)("div",{className:"grow flex-col flex",children:[(0,l.jsx)("p",{className:"text-foreground",children:"Not sure what to do?"}),(0,l.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Browse our documentation"})]}),(0,l.jsx)(x.z,{type:"default",iconRight:(0,l.jsx)(G.Z,{}),children:(0,l.jsx)("a",{href:"https://supabase.com/docs/guides/realtime",target:"_blank",rel:"noreferrer",children:"Documentation"})})]})]})]}):(0,l.jsx)(Inspector_NoChannelEmptyState,{})})},RowRenderer=(e,s)=>(0,l.jsx)(V.X2,{...s,isRowSelected:!1,selectedCellIdx:void 0},e);var Inspector_MessagesTable=e=>{let{enabled:s,hasChannelSet:t,data:r=[],showSendMessage:n}=e,[o,i]=(0,a.useState)(null),c=JSON.stringify(r);return((0,a.useEffect)(()=>{if(!r)return;let e=r.find(e=>e.id===(null==o?void 0:o.id));e||i(null)},[c]),r)?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("section",{className:"flex w-full flex-col",style:{maxHeight:"calc(100vh - 42px - 3rem)"},children:[(0,l.jsx)(Q.Z,{active:s}),(0,l.jsxs)("div",{className:(0,N.cn)("flex h-full flex-row",s?"border-brand-400":null),children:[(0,l.jsxs)("div",{className:"flex flex-grow flex-col",children:[s&&(0,l.jsxs)("div",{className:"w-full h-8 px-4 bg-surface-100 border-b items-center inline-flex justify-between text-foreground-light",children:[(0,l.jsxs)("div",{className:"inline-flex gap-2.5 text-xs",children:[(0,l.jsx)(J.Z,{size:"16",className:"animate-spin"}),(0,l.jsx)("div",{children:"Listening"}),(0,l.jsx)("div",{children:"•"}),(0,l.jsx)("div",{children:r.length>0?r.length>=100?"Found a large number of messages, showing only the latest 100...":"Found ".concat(r.length," messages..."):"No message found yet..."})]}),(0,l.jsx)(x.z,{type:"text",onClick:n,className:"group",children:(0,l.jsx)("span",{className:"text-foreground-light group-hover:text-foreground transition",children:"Broadcast a message"})})]}),(0,l.jsx)(V.ZP,{className:"data-grid--simple-logs h-full border-b-0",rowHeight:40,headerRowHeight:0,onSelectedCellChange:e=>{let{rowIdx:s}=e;i(r[s])},selectedRows:new Set([]),columns:es,rowClass:e=>(0,N.cn)(["font-mono tracking-tight",H()(e,o)?"bg-scale-800 rdg-row--focused":" bg-scale-200 hover:bg-scale-300 cursor-pointer",isErrorLog(e)&&"!bg-warning-300"]),rows:r,rowKeyGetter:e=>e.id,renderers:{renderRow:RowRenderer,noRowsFallback:(0,l.jsx)("div",{className:"mx-auto flex h-full w-full items-center justify-center space-y-12 py-4 transition-all delay-200 duration-500",children:(0,l.jsx)(NoResultAlert,{enabled:s,hasChannelSet:t,showSendMessage:n})})}})]}),(0,l.jsx)("div",{className:"flex w-1/2 flex-col",children:(0,l.jsx)(Inspector_MessageSelection,{onClose:()=>i(null),log:o})})]})]})}):null},et=t(35229),el=t(71813);let er={message:"Test message",payload:'{ "message": "Hello World" }'},SendMessageModal=e=>{let{visible:s,onSelectCancel:t,onSelectConfirm:r}=e,[n,o]=(0,a.useState)(),[i,c]=(0,a.useState)(er);return(0,a.useEffect)(()=>{s&&(o(void 0),c(er))},[s]),(0,l.jsx)(R.C,{size:"medium",alignFooter:"right",header:"Broadcast a message to all clients",visible:s,loading:!1,onCancel:t,onConfirm:()=>{let e=(0,el.dW)(i.payload);void 0===e?o("Please provide a valid JSON"):r({...i,payload:e})},children:(0,l.jsx)(R.C.Content,{children:(0,l.jsxs)("div",{className:"py-4 flex flex-col gap-y-4",children:[(0,l.jsx)(k.Z,{label:"Message name",size:"small",className:"flex-grow",value:i.message,onChange:e=>c({...i,message:e.target.value})}),(0,l.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,l.jsx)("p",{className:"text-sm text-scale-1100",children:"Message payload"}),(0,l.jsx)(et.ZP,{id:"message-payload",language:"json",className:"!mb-0 h-32 overflow-hidden rounded border",onInputChange:e=>c({...i,payload:null!=e?e:"{}"}),options:{wordWrap:"off",contextmenu:!1},value:i.payload}),void 0!==n&&(0,l.jsx)("p",{className:"text-sm text-red-900",children:n})]})]})})})};var ea=t(70536),en=t(829),eo=t.n(en),ei=t(85701),ec=t.n(ei),ed=t(62202),ex=t(47095);function reducer(e,s){if("clear"===s.type)return ex.Z6;let t=ec()(eo()([{id:(0,el.k$)(),timestamp:new Date().getTime(),message:s.payload.messageType,metadata:s.payload.metadata},...e],e=>-e.timestamp),100);return t}let useRealtimeMessages=e=>{let{enabled:s,channelName:t,projectRef:l,logLevel:r,token:n,schema:o,table:i,filter:c,bearer:d,enablePresence:x,enableDbChanges:h,enableBroadcast:m}=e,[u,p]=(0,a.useState)("https://".concat(l,".supabase.co"));(0,F.q)({projectRef:l},{onSuccess:e=>{p("".concat(e.autoApiService.protocol,"://").concat(e.autoApiService.endpoint))}});let[g,f]=(0,a.useReducer)(reducer,[]),pushMessage=(e,s)=>{f({type:"add",payload:{messageType:e,metadata:s}})},[j,v]=(0,a.useState)(),[b,y]=(0,a.useState)();(0,a.useEffect)(()=>{if(!s)return;let e=(0,ea.eI)(u,n,{realtime:{params:{log_level:r}}});return""!=d&&e.realtime.setAuth(d),v(e),()=>{null==j||j.realtime.disconnect(),v(void 0)}},[s,d,u,r,n]),(0,a.useEffect)(()=>{if(!j)return;f({type:"clear"});let e=null==j?void 0:j.channel(t,{config:{broadcast:{self:!0}}});if(e.on("system",{},e=>{pushMessage("SYSTEM",e)}),m&&e.on("broadcast",{event:"*"},e=>pushMessage("BROADCAST",e)),x&&e.on("presence",{event:"*"},e=>{pushMessage("PRESENCE",e)}),h){let s={event:"*",schema:o,table:i,filter:void 0};""!==c&&(s.filter=c),e.on("postgres_changes",s,e=>{let s=performance.now()+performance.timeOrigin,t=Date.parse(e.commit_timestamp);pushMessage("POSTGRES",{...e,latency:s-t})})}return e.subscribe(async(s,t)=>{"SUBSCRIBED"===s&&x&&e.send({type:"presence",event:"TRACK",payload:{name:"user_name_"+Math.floor(100*Math.random()),t:performance.now()}})}),y(e),()=>{e.unsubscribe(),y(void 0)}},[j,t,m,h,x,c,u,o,i]);let N=(0,a.useCallback)((e,s)=>{b?(b.send({type:"broadcast",event:e,payload:s}),ed.ZP.success("Successfully broadcasted message")):ed.ZP.error("Failed to broadcast message: channel has not been set")},[b]);return{logData:g,sendMessage:N}},RealtimeInspector=()=>{let{ref:e}=(0,n.UO)(),[s,t]=(0,a.useState)(!1),[r,o]=(0,a.useState)({enabled:!1,projectRef:e,channelName:"",logLevel:"info",token:"",schema:"public",table:"*",filter:void 0,bearer:null,enablePresence:!0,enableDbChanges:!0,enableBroadcast:!0}),{logData:i,sendMessage:c}=useRealtimeMessages(r);return(0,l.jsxs)("div",{className:"flex flex-col grow h-full",children:[(0,l.jsx)(Header,{config:r,onChangeConfig:o}),(0,l.jsx)("div",{className:"relative flex flex-col grow",children:(0,l.jsx)("div",{className:"flex grow",children:(0,l.jsx)(Inspector_MessagesTable,{hasChannelSet:r.channelName.length>0,enabled:r.enabled,data:i,showSendMessage:()=>t(!0)})})}),(0,l.jsx)(SendMessageModal,{visible:s,onSelectCancel:()=>t(!1),onSelectConfirm:e=>{c(e.message,e.payload),t(!1)}})]})};var eh=t(5632),em=t(79552),eu=t(89465),ep=t(51373);let generateRealtimeMenu=e=>{var s;let t=null!==(s=null==e?void 0:e.ref)&&void 0!==s?s:"default";return[{title:"Realtime",items:[{name:"Inspector",key:"inspector",url:"/project/".concat(t,"/realtime/inspector"),items:[]}]}]};var eg=(0,eu.QO)(e=>{let{children:s}=e,{meta:t}=(0,eu.oR)(),r=(0,eu.Vm)(),a=(0,eh.useRouter)(),n=a.pathname.split("/")[4];return(0,l.jsx)(ep.ZP,{isLoading:!1,product:"Realtime",productMenu:(0,l.jsx)(em.Z,{page:n,menu:generateRealtimeMenu(r)}),children:s})}),ef=t(97131);let InspectorPage=()=>{let e=(0,eu.Xo)(r.KA.READ,"service_api_keys");return e?(0,l.jsx)(RealtimeInspector,{}):(0,l.jsx)(ef.Z,{isFullPage:!0,resourceText:"access your project's realtime functionalities"})};InspectorPage.getLayout=e=>(0,l.jsx)(eg,{title:"Realtime",children:e});var ej=InspectorPage}},function(e){e.O(0,[1715,1187,6653,3844,8421,9362,4796,806,2591,1971,1915,4079,4964,8211,452,8108,9774,2888,179],function(){return e(e.s=86350)}),_N_E=e.O()}]);